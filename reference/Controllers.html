<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Class of Controller — Controllers • TrialSimulator</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Class of Controller — Controllers"><meta name="description" content="Create a class of controller to run a trial.
Public methods in this R6 class are used in developing
this package. Thus, we have to export the whole R6 class which exposures all
public methods. However, only the public methods in the list below are
useful to end users.

$run()
$get_output()
$reset()

"><meta property="og:description" content="Create a class of controller to run a trial.
Public methods in this R6 class are used in developing
this package. Thus, we have to export the whole R6 class which exposures all
public methods. However, only the public methods in the list below are
useful to end users.

$run()
$get_output()
$reset()

"><meta property="og:image" content="https://zhangh12.github.io/TrialSimulator/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TrialSimulator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/actionFunctions.html">Specify Actions to Execute at Trial Milestones</a></li>
    <li><a class="dropdown-item" href="../articles/adaptiveDesign.html">An Example of Simulating a Trial with Adaptive Design</a></li>
    <li><a class="dropdown-item" href="../articles/conditionSystem.html">Condition System for Triggering Milestones in a Trial</a></li>
    <li><a class="dropdown-item" href="../articles/defineArms.html">Define and Summarize Arms in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/defineLongitudinalEndpoints.html">Define Longitudinal Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/defineNonTimeToEventEndpoints.html">Define Non-Time-to-Event Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/defineTimeToEventEndpoints.html">Define Time-to-Event Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/doseRanging.html">Dose-Ranging Study</a></li>
    <li><a class="dropdown-item" href="../articles/fixedDesign.html">An Example of Fixed Design with Two Correlated Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/responseAdaptive.html">Designs with Response-Adaptive Randomization</a></li>
    <li><a class="dropdown-item" href="../articles/simulatePfsAndOs.html">Simulate Correlated Progression-Free Survival and Overall Survival as Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/wrappers.html">Wrapper Functions of Common Statistical Methods in TrialSimulator</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zhangh12/TrialSimulator/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Class of Controller</h1>
      <small class="dont-index">Source: <a href="https://github.com/zhangh12/TrialSimulator/blob/main/R/Controllers.R" class="external-link"><code>R/Controllers.R</code></a></small>
      <div class="d-none name"><code>Controllers.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a class of controller to run a trial.</p>
<p>Public methods in this R6 class are used in developing
this package. Thus, we have to export the whole R6 class which exposures all
public methods. However, only the public methods in the list below are
useful to end users.</p>
<ul><li><p><code>$run()</code></p></li>
<li><p><code>$get_output()</code></p></li>
<li><p><code>$reset()</code></p></li>
</ul></div>


    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Controllers-new"><code>Controllers$new()</code></a></p></li>
<li><p><a href="#method-Controllers-get_listener"><code>Controllers$get_listener()</code></a></p></li>
<li><p><a href="#method-Controllers-get_trial"><code>Controllers$get_trial()</code></a></p></li>
<li><p><a href="#method-Controllers-mute"><code>Controllers$mute()</code></a></p></li>
<li><p><a href="#method-Controllers-reset"><code>Controllers$reset()</code></a></p></li>
<li><p><a href="#method-Controllers-get_output"><code>Controllers$get_output()</code></a></p></li>
<li><p><a href="#method-Controllers-run"><code>Controllers$run()</code></a></p></li>
<li><p><a href="#method-Controllers-clone"><code>Controllers$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Controllers-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>initialize a controller of the trial</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Controllers.html">Controllers</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">trial</span>, <span class="va">listener</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>trial</code></dt>
<dd><p>a trial object returned from <code><a href="trial.html">trial()</a></code>.</p></dd>


<dt><code>listener</code></dt>
<dd><p>a listener object returned from <code><a href="listener.html">listener()</a></code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Controllers-get_listener"></a><div class="section">
<h3 id="method-get-listener-">Method <code>get_listener()</code><a class="anchor" aria-label="anchor" href="#method-get-listener-"></a></h3>
<p>return listener in a controller.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Controllers</span><span class="op">$</span><span class="fu">get_listener</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Controllers-get_trial"></a><div class="section">
<h3 id="method-get-trial-">Method <code>get_trial()</code><a class="anchor" aria-label="anchor" href="#method-get-trial-"></a></h3>
<p>return trial in a controller.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Controllers</span><span class="op">$</span><span class="fu">get_trial</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Controllers-mute"></a><div class="section">
<h3 id="method-mute-">Method <code>mute()</code><a class="anchor" aria-label="anchor" href="#method-mute-"></a></h3>
<p>mute all messages (not including warnings).</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Controllers</span><span class="op">$</span><span class="fu">mute</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>silent</code></dt>
<dd><p>logical.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Controllers-reset"></a><div class="section">
<h3 id="method-reset-">Method <code>reset()</code><a class="anchor" aria-label="anchor" href="#method-reset-"></a></h3>
<p>reset the trial and listener registered to the controller before running
additional replicate of simulation. This is usually done between two
calls of <code>controller$run()</code>.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Controllers</span><span class="op">$</span><span class="fu">reset</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Controllers-get_output"></a><div class="section">
<h3 id="method-get-output-">Method <code>get_output()</code><a class="anchor" aria-label="anchor" href="#method-get-output-"></a></h3>
<p>return a data frame of all current outputs saved by calling <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code>.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Controllers</span><span class="op">$</span><span class="fu">get_output</span><span class="op">(</span>cols <span class="op">=</span> <span class="cn">NULL</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span>, tidy <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>cols</code></dt>
<dd><p>character vector. Columns to be returned from the data frame
of simulation outputs. If <code>NULL</code>, all columns are returned.</p></dd>


<dt><code>simplify</code></dt>
<dd><p>logical. Return vector rather than a data frame of one
column when <code>length(cols) == 1</code> and <code>simplify == TRUE</code>.</p></dd>


<dt><code>tidy</code></dt>
<dd><p>logical. <code>TrialSimulator</code> automatically records a set
of standard outputs at milestones, even when <code>doNothing</code> is used
as action functions. These includes time of triggering milestones,
number of observed events for time-to-event endpoints, and number of
non-missing readouts for non-TTE endpoints
(see <code><a href="../articles/actionFunctions.html">vignette('actionFunctions')</a></code>). This usually mean a large
number of columns in outputs. If users have no intent to summarize a
trial on these columns, setting <code>tidy = TRUE</code> can eliminate these
columns from <code>get_output()</code>. This is useful to reduced the size of
output data frame when a large number of replicates are done for
simulation. Note that currently we use regex
<code>"^n_events_&lt;.*?&gt;_&lt;.*?&gt;$"</code> and
<code>"^milestone_time_&lt;.*?&gt;$"</code> to match columns to be eliminated.
If users plan to use <code>tidy = TRUE</code>, caution is needed when naming
custom outputs in <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code>. Default <code>FALSE</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Controllers-run"></a><div class="section">
<h3 id="method-run-">Method <code>run()</code><a class="anchor" aria-label="anchor" href="#method-run-"></a></h3>
<p>run trial simulation.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Controllers</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_workers <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  plot_event <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  dry_run <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n</code></dt>
<dd><p>integer. Number of replicates of simulation.
<code>n = 1</code> by default. Simulation results can be accessed by
<code>controller$get_output()</code>.</p></dd>


<dt><code>n_workers</code></dt>
<dd><p>integer. Number of parallel workers. When
<code>n_workers = 1</code> (default), replicates are run sequentially.
When <code>n_workers &gt; 1</code>, replicates are distributed across
parallel workers using the <code>mirai</code> package, which must be
installed separately. Each worker receives a serialized copy of
the trial and listener objects and runs its share of replicates
independently. If any replicate encounters an error, execution
stops and already-collected results are preserved in
<code>$get_output()</code>. To debug, manually set <code>seed</code> in
<code><a href="trial.html">trial()</a></code> and <code>n_workers = 1</code> in <code>run()</code> for reproduced
results. Note that optimal <code>n_workers</code> may not be
<code><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">parallel::detectCores()</a></code>. For example, Macbook with M1/M2/M3 chips
may have performance cores and efficiency cores. To achieve the best
parallel performance, one may want to use the performance cores only.
For a M1 laptop with 4 performance cores, <code>n_workers = 3</code> may give
the best performance.</p></dd>


<dt><code>plot_event</code></dt>
<dd><p>logical. Create event plot if <code>TRUE</code>. Users
should set it to be <code>FALSE</code> if <code>n &gt; 1</code>. Forced to
<code>FALSE</code> when <code>n_workers &gt; 1</code>.</p></dd>


<dt><code>silent</code></dt>
<dd><p>logical. <code>TRUE</code> if muting all messages during a
trial. Note that warning messages are still displayed.</p></dd>


<dt><code>dry_run</code></dt>
<dd><p>logical. We are considering retire this argument.
<code>TRUE</code> if action function provided by users is
ignored and an internal default action <code>.default_action</code> is called
instead. This default function only locks data when the milestone is
triggered. Milestone time and number of endpoints' events or sample sizes
are saved. It is suggested to set <code>dry_run = TRUE</code> to estimate
distributions of triggering time and number of events before formally
using custom action functions if a fixed design is in use.
This helps determining planned maximum
information for group sequential design and reasonable time of milestone
of interest when planning a trial. Set it to <code>FALSE</code> for formal
simulations. However, for an adaptive design where arm(s) could
possibly be added or removed, setting <code>dry_run</code> to <code>TRUE</code>
is usually not helpful because adaption should be executed
before estimating the milestone time.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Controllers-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Controllers</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Han Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

