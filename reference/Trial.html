<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Class of Trial — Trial • TrialSimulator</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Class of Trial — Trial"><meta name="description" content="Create a class of trial."><meta property="og:description" content="Create a class of trial."><meta property="og:image" content="https://zhangh12.github.io/TrialSimulator/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TrialSimulator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.55.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/adaptiveDesign.html">An Example of Simulating a Trial with Adaptive Design</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons with graphicalMCP and gMCP</a></li>
    <li><a class="dropdown-item" href="../articles/conditionSystem.html">Condition System for Triggering Events in a Trial</a></li>
    <li><a class="dropdown-item" href="../articles/defineNonTimeToEventEndpoints.html">Define Non-Time-to-Event Endpoints in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/defineTimeToEventEndpoints.html">Define Time-to-Event Endpoints in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/designDocument.html">Modular Clinical Trial Simulation: Overview of Core Functions and Workflow</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Class of Trial</h1>

      <div class="d-none name"><code>Trial.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a class of trial.</p>
    </div>


    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Trial-new"><code>Trial$new()</code></a></p></li>
<li><p><a href="#method-Trial-get_trial_data"><code>Trial$get_trial_data()</code></a></p></li>
<li><p><a href="#method-Trial-get_duration"><code>Trial$get_duration()</code></a></p></li>
<li><p><a href="#method-Trial-set_enroller"><code>Trial$set_enroller()</code></a></p></li>
<li><p><a href="#method-Trial-get_enroller"><code>Trial$get_enroller()</code></a></p></li>
<li><p><a href="#method-Trial-set_dropout"><code>Trial$set_dropout()</code></a></p></li>
<li><p><a href="#method-Trial-get_dropout"><code>Trial$get_dropout()</code></a></p></li>
<li><p><a href="#method-Trial-roll_back"><code>Trial$roll_back()</code></a></p></li>
<li><p><a href="#method-Trial-remove_arms"><code>Trial$remove_arms()</code></a></p></li>
<li><p><a href="#method-Trial-update_sample_ratio"><code>Trial$update_sample_ratio()</code></a></p></li>
<li><p><a href="#method-Trial-add_arms"><code>Trial$add_arms()</code></a></p></li>
<li><p><a href="#method-Trial-get_name"><code>Trial$get_name()</code></a></p></li>
<li><p><a href="#method-Trial-get_description"><code>Trial$get_description()</code></a></p></li>
<li><p><a href="#method-Trial-get_arms"><code>Trial$get_arms()</code></a></p></li>
<li><p><a href="#method-Trial-get_arms_name"><code>Trial$get_arms_name()</code></a></p></li>
<li><p><a href="#method-Trial-get_number_arms"><code>Trial$get_number_arms()</code></a></p></li>
<li><p><a href="#method-Trial-has_arm"><code>Trial$has_arm()</code></a></p></li>
<li><p><a href="#method-Trial-get_an_arm"><code>Trial$get_an_arm()</code></a></p></li>
<li><p><a href="#method-Trial-get_sample_ratio"><code>Trial$get_sample_ratio()</code></a></p></li>
<li><p><a href="#method-Trial-get_number_patients"><code>Trial$get_number_patients()</code></a></p></li>
<li><p><a href="#method-Trial-get_number_enrolled_patients"><code>Trial$get_number_enrolled_patients()</code></a></p></li>
<li><p><a href="#method-Trial-get_number_unenrolled_patients"><code>Trial$get_number_unenrolled_patients()</code></a></p></li>
<li><p><a href="#method-Trial-get_randomization_queue"><code>Trial$get_randomization_queue()</code></a></p></li>
<li><p><a href="#method-Trial-get_enroll_time"><code>Trial$get_enroll_time()</code></a></p></li>
<li><p><a href="#method-Trial-enroll_a_patient"><code>Trial$enroll_a_patient()</code></a></p></li>
<li><p><a href="#method-Trial-enroll_patients"><code>Trial$enroll_patients()</code></a></p></li>
<li><p><a href="#method-Trial-set_current_time"><code>Trial$set_current_time()</code></a></p></li>
<li><p><a href="#method-Trial-get_current_time"><code>Trial$get_current_time()</code></a></p></li>
<li><p><a href="#method-Trial-get_event_tables"><code>Trial$get_event_tables()</code></a></p></li>
<li><p><a href="#method-Trial-get_data_lock_time_by_event_number"><code>Trial$get_data_lock_time_by_event_number()</code></a></p></li>
<li><p><a href="#method-Trial-get_data_lock_time_by_calendar_time"><code>Trial$get_data_lock_time_by_calendar_time()</code></a></p></li>
<li><p><a href="#method-Trial-get_locked_data"><code>Trial$get_locked_data()</code></a></p></li>
<li><p><a href="#method-Trial-get_locked_data_name"><code>Trial$get_locked_data_name()</code></a></p></li>
<li><p><a href="#method-Trial-get_event_number"><code>Trial$get_event_number()</code></a></p></li>
<li><p><a href="#method-Trial-save_event_time"><code>Trial$save_event_time()</code></a></p></li>
<li><p><a href="#method-Trial-get_event_time"><code>Trial$get_event_time()</code></a></p></li>
<li><p><a href="#method-Trial-lock_data"><code>Trial$lock_data()</code></a></p></li>
<li><p><a href="#method-Trial-event_plot"><code>Trial$event_plot()</code></a></p></li>
<li><p><a href="#method-Trial-censor_trial_data"><code>Trial$censor_trial_data()</code></a></p></li>
<li><p><a href="#method-Trial-save"><code>Trial$save()</code></a></p></li>
<li><p><a href="#method-Trial-bind"><code>Trial$bind()</code></a></p></li>
<li><p><a href="#method-Trial-save_custom_data"><code>Trial$save_custom_data()</code></a></p></li>
<li><p><a href="#method-Trial-get_custom_data"><code>Trial$get_custom_data()</code></a></p></li>
<li><p><a href="#method-Trial-get_output"><code>Trial$get_output()</code></a></p></li>
<li><p><a href="#method-Trial-mute"><code>Trial$mute()</code></a></p></li>
<li><p><a href="#method-Trial-set_tester"><code>Trial$set_tester()</code></a></p></li>
<li><p><a href="#method-Trial-get_tester"><code>Trial$get_tester()</code></a></p></li>
<li><p><a href="#method-Trial-independentIncrement"><code>Trial$independentIncrement()</code></a></p></li>
<li><p><a href="#method-Trial-dunnettTest"><code>Trial$dunnettTest()</code></a></p></li>
<li><p><a href="#method-Trial-closedTest"><code>Trial$closedTest()</code></a></p></li>
<li><p><a href="#method-Trial-get_seed"><code>Trial$get_seed()</code></a></p></li>
<li><p><a href="#method-Trial-print"><code>Trial$print()</code></a></p></li>
<li><p><a href="#method-Trial-clone"><code>Trial$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Trial-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>initialize a trial</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">n_patients</span>,</span>
<span>  <span class="va">duration</span>,</span>
<span>  description <span class="op">=</span> <span class="va">name</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">enroller</span>,</span>
<span>  dropout <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>character. Name of trial.</p></dd>


<dt><code>n_patients</code></dt>
<dd><p>integer. Maximum number of patients could be enrolled
to the trial.</p></dd>


<dt><code>duration</code></dt>
<dd><p>Numeric. Trial duration.</p></dd>


<dt><code>description</code></dt>
<dd><p>character. Optional for description of the trial. By
default it is set to be trial's <code>name</code>.</p></dd>


<dt><code>seed</code></dt>
<dd><p>random seed. If <code>NULL</code>, <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> will not be
called, which uses seed set outside.</p></dd>


<dt><code>enroller</code></dt>
<dd><p>a function returning a vector enrollment time for
patients. Its first argument is the number of enrolled patients.</p></dd>


<dt><code>dropout</code></dt>
<dd><p>a function returning a vector of dropout time for
patients. Its first argument is the number of enrolled patients.</p></dd>


<dt><code>...</code></dt>
<dd><p>arguments of <code>enroller</code> and <code>dropout</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_trial_data"></a><div class="section">
<h3 id="method-get-trial-data-">Method <code>get_trial_data()</code><a class="anchor" aria-label="anchor" href="#method-get-trial-data-"></a></h3>
<p>return trial data of enrolled patients at the time of this
function is called</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_trial_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_duration"></a><div class="section">
<h3 id="method-get-duration-">Method <code>get_duration()</code><a class="anchor" aria-label="anchor" href="#method-get-duration-"></a></h3>
<p>return maximum duration of a trial</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_duration</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-set_enroller"></a><div class="section">
<h3 id="method-set-enroller-">Method <code>set_enroller()</code><a class="anchor" aria-label="anchor" href="#method-set-enroller-"></a></h3>
<p>set recruitment curve when initialize a
trial.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">set_enroller</span><span class="op">(</span><span class="va">func</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>func</code></dt>
<dd><p>function to generate enrollment time. It can be built-in
function like `rexp` or customized functions like `StaggeredRecruiter`.</p></dd>


<dt><code>...</code></dt>
<dd><p>arguments for <code>func</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_enroller"></a><div class="section">
<h3 id="method-get-enroller-">Method <code>get_enroller()</code><a class="anchor" aria-label="anchor" href="#method-get-enroller-"></a></h3>
<p>get function of recruitment curve</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_enroller</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-set_dropout"></a><div class="section">
<h3 id="method-set-dropout-">Method <code>set_dropout()</code><a class="anchor" aria-label="anchor" href="#method-set-dropout-"></a></h3>
<p>set distribution of drop out time. This can be done when initialize a
trial, or when updating a trial in adaptive design.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">set_dropout</span><span class="op">(</span><span class="va">func</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>func</code></dt>
<dd><p>function to generate dropout time. It can be built-in
function like `rexp` or customized functions.</p></dd>


<dt><code>...</code></dt>
<dd><p>arguments for <code>func</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_dropout"></a><div class="section">
<h3 id="method-get-dropout-">Method <code>get_dropout()</code><a class="anchor" aria-label="anchor" href="#method-get-dropout-"></a></h3>
<p>get generator of dropout time</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_dropout</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-roll_back"></a><div class="section">
<h3 id="method-roll-back-">Method <code>roll_back()</code><a class="anchor" aria-label="anchor" href="#method-roll-back-"></a></h3>
<p>roll back data to current time of trial. By doing so,
<code>Trial$trial_data</code> will be cut at current time, and data after then
are deleted. However, <code>Trial$enroll_time</code> after current time are
kept unchanged because that is planned enrollment curve.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">roll_back</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-remove_arms"></a><div class="section">
<h3 id="method-remove-arms-">Method <code>remove_arms()</code><a class="anchor" aria-label="anchor" href="#method-remove-arms-"></a></h3>
<p>remove arms from a trial. <code>enroll_patients()</code> will be always called
at the end to enroll all remaining patients after
<code>Trial$get_current_time()</code>. This function may be used with futility
analysis, dose selection, enrichment analysis (sub-population) or
interim analysis (early stop for efficacy)</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">remove_arms</span><span class="op">(</span><span class="va">arms_name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>arms_name</code></dt>
<dd><p>character vector. Name of arms to be removed.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-update_sample_ratio"></a><div class="section">
<h3 id="method-update-sample-ratio-">Method <code>update_sample_ratio()</code><a class="anchor" aria-label="anchor" href="#method-update-sample-ratio-"></a></h3>
<p>update sample ratio of an arm. This could happen after an arm is added
or removed. We may want to update sample ratio of unaffected arms as
well. This function can only update sample ratio for one arm at a time.
Once sample ratio is updated, trial data should be rolled back with
updated randomization queue. Data of unenrolled patients should be
re-sampled as well.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">update_sample_ratio</span><span class="op">(</span><span class="va">arm_name</span>, <span class="va">sample_ratio</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>arm_name</code></dt>
<dd><p>character. Name of an arm of length 1.</p></dd>


<dt><code>sample_ratio</code></dt>
<dd><p>integer. Sample ratio of the arm.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-add_arms"></a><div class="section">
<h3 id="method-add-arms-">Method <code>add_arms()</code><a class="anchor" aria-label="anchor" href="#method-add-arms-"></a></h3>
<p>add one or more arms to the trial. <code>enroll_patients()</code> will be
called at the end to enroll all remaining patients in
<code>private$randomization_queue</code>. This function can be used in two
scenarios.
(1) add arms right after a trial is created (i.e., <code>Trial$new(...)</code>).
<code>sample_ratio</code> and arms added through <code>...</code> should be of same
length.
(2) add arms to a trial already with arm(s)</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">add_arms</span><span class="op">(</span><span class="va">sample_ratio</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>sample_ratio</code></dt>
<dd><p>integer vector. Sample ratio for permuted block
randomization. It will be appended to existing sample ratio in the trial.</p></dd>


<dt><code>...</code></dt>
<dd><p>one or more objects of class <code>Arm</code>. One exception in
<code>...</code> is an argument <code>enforce</code>. When <code>enforce = TRUE</code>,
sample ratio of newly added arm. It rolls back all patients after
<code>Trial$get_current_time()</code>, i.e. redo randomization for those
patients. This can be useful to add arms one by one when creating a trial.
Note that we can run <code>Trial$add_arm(sample_ratio1, arm1)</code> followed
by <code>Trial$add_arm(sample_ratio2, enforce = TRUE, arm2)</code>.
We would expected similar result with
<code>Trial$add_arms(c(sample_ratio1, sample_ratio2), arm1, arm2)</code>. Note
that these two method won't return exactly the same trial because
randomization_queue were generated twice in the first approach but only
once in the second approach. But statistically, they are equivalent and
of the same distribution.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_name"></a><div class="section">
<h3 id="method-get-name-">Method <code>get_name()</code><a class="anchor" aria-label="anchor" href="#method-get-name-"></a></h3>
<p>return name of trial</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_name</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_description"></a><div class="section">
<h3 id="method-get-description-">Method <code>get_description()</code><a class="anchor" aria-label="anchor" href="#method-get-description-"></a></h3>
<p>return description of trial</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_description</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_arms"></a><div class="section">
<h3 id="method-get-arms-">Method <code>get_arms()</code><a class="anchor" aria-label="anchor" href="#method-get-arms-"></a></h3>
<p>return a list of arms in the trial</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_arms</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_arms_name"></a><div class="section">
<h3 id="method-get-arms-name-">Method <code>get_arms_name()</code><a class="anchor" aria-label="anchor" href="#method-get-arms-name-"></a></h3>
<p>return arms' name of trial</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_arms_name</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_number_arms"></a><div class="section">
<h3 id="method-get-number-arms-">Method <code>get_number_arms()</code><a class="anchor" aria-label="anchor" href="#method-get-number-arms-"></a></h3>
<p>get number of arms in the trial</p><div class="section">
<h4 id="usage-15">Usage<a class="anchor" aria-label="anchor" href="#usage-15"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_number_arms</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-has_arm"></a><div class="section">
<h3 id="method-has-arm-">Method <code>has_arm()</code><a class="anchor" aria-label="anchor" href="#method-has-arm-"></a></h3>
<p>check if the trial has any arm. Return <code>TRUE</code> or <code>FALSE</code>.</p><div class="section">
<h4 id="usage-16">Usage<a class="anchor" aria-label="anchor" href="#usage-16"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">has_arm</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_an_arm"></a><div class="section">
<h3 id="method-get-an-arm-">Method <code>get_an_arm()</code><a class="anchor" aria-label="anchor" href="#method-get-an-arm-"></a></h3>
<p>return an arm</p><div class="section">
<h4 id="usage-17">Usage<a class="anchor" aria-label="anchor" href="#usage-17"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_an_arm</span><span class="op">(</span><span class="va">arm_name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-6">Arguments<a class="anchor" aria-label="anchor" href="#arguments-6"></a></h4>
<p></p><div class="arguments"><dl><dt><code>arm_name</code></dt>
<dd><p>character, name of arm to be extracted</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_sample_ratio"></a><div class="section">
<h3 id="method-get-sample-ratio-">Method <code>get_sample_ratio()</code><a class="anchor" aria-label="anchor" href="#method-get-sample-ratio-"></a></h3>
<p>return current sample ratio of the trial. The ratio can probably change
during the trial (e.g., arm is removed or added)</p><div class="section">
<h4 id="usage-18">Usage<a class="anchor" aria-label="anchor" href="#usage-18"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_sample_ratio</span><span class="op">(</span>arm_names <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-7">Arguments<a class="anchor" aria-label="anchor" href="#arguments-7"></a></h4>
<p></p><div class="arguments"><dl><dt><code>arm_names</code></dt>
<dd><p>character vector of arms.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_number_patients"></a><div class="section">
<h3 id="method-get-number-patients-">Method <code>get_number_patients()</code><a class="anchor" aria-label="anchor" href="#method-get-number-patients-"></a></h3>
<p>return number of patients when planning the trial</p><div class="section">
<h4 id="usage-19">Usage<a class="anchor" aria-label="anchor" href="#usage-19"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_number_patients</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_number_enrolled_patients"></a><div class="section">
<h3 id="method-get-number-enrolled-patients-">Method <code>get_number_enrolled_patients()</code><a class="anchor" aria-label="anchor" href="#method-get-number-enrolled-patients-"></a></h3>
<p>return number of enrolled (randomized) patients</p><div class="section">
<h4 id="usage-20">Usage<a class="anchor" aria-label="anchor" href="#usage-20"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_number_enrolled_patients</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_number_unenrolled_patients"></a><div class="section">
<h3 id="method-get-number-unenrolled-patients-">Method <code>get_number_unenrolled_patients()</code><a class="anchor" aria-label="anchor" href="#method-get-number-unenrolled-patients-"></a></h3>
<p>return number of unenrolled patients</p><div class="section">
<h4 id="usage-21">Usage<a class="anchor" aria-label="anchor" href="#usage-21"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_number_unenrolled_patients</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_randomization_queue"></a><div class="section">
<h3 id="method-get-randomization-queue-">Method <code>get_randomization_queue()</code><a class="anchor" aria-label="anchor" href="#method-get-randomization-queue-"></a></h3>
<p>return randomization queue of planned but not yet enrolled patients.
This function does not update randomization_queue, just return its value
for debugging purpose.</p><div class="section">
<h4 id="usage-22">Usage<a class="anchor" aria-label="anchor" href="#usage-22"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_randomization_queue</span><span class="op">(</span>index <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-8">Arguments<a class="anchor" aria-label="anchor" href="#arguments-8"></a></h4>
<p></p><div class="arguments"><dl><dt><code>index</code></dt>
<dd><p>index to be extracted. Return all queue if <code>NULL</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_enroll_time"></a><div class="section">
<h3 id="method-get-enroll-time-">Method <code>get_enroll_time()</code><a class="anchor" aria-label="anchor" href="#method-get-enroll-time-"></a></h3>
<p>return enrollment time of planned but not yet enrolled patients.
This function does not update enroll_time, just return its value
for debugging purpose.</p><div class="section">
<h4 id="usage-23">Usage<a class="anchor" aria-label="anchor" href="#usage-23"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_enroll_time</span><span class="op">(</span>index <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-9">Arguments<a class="anchor" aria-label="anchor" href="#arguments-9"></a></h4>
<p></p><div class="arguments"><dl><dt><code>index</code></dt>
<dd><p>index to extract. Return all enroll time if <code>NULL</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-enroll_a_patient"></a><div class="section">
<h3 id="method-enroll-a-patient-">Method <code>enroll_a_patient()</code><a class="anchor" aria-label="anchor" href="#method-enroll-a-patient-"></a></h3>
<p>assign a new patient to an arm based on planned randomization queue
I may consider make this function deprecated. Instead, I'd like to
have a function to sample the remaining n patients, with n as an argument.
Reason: if an action (analysis, add/remove arm, early stop) is triggered
based on number of event of TTE, we may need to sample ALL patients to
know the accurate time point. With an enrollment function of more than
one patient, we can find out the time point and roll back to then, and
recover randomization queue and enrollment time for the remaining patients.</p><div class="section">
<h4 id="usage-24">Usage<a class="anchor" aria-label="anchor" href="#usage-24"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">enroll_a_patient</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-enroll_patients"></a><div class="section">
<h3 id="method-enroll-patients-">Method <code>enroll_patients()</code><a class="anchor" aria-label="anchor" href="#method-enroll-patients-"></a></h3>
<p>assign new patients to pre-planned randomization queue at pre-specified
enrollment time.</p><div class="section">
<h4 id="usage-25">Usage<a class="anchor" aria-label="anchor" href="#usage-25"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">enroll_patients</span><span class="op">(</span>n_patients <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-10">Arguments<a class="anchor" aria-label="anchor" href="#arguments-10"></a></h4>
<p></p><div class="arguments"><dl><dt><code>n_patients</code></dt>
<dd><p>number of new patients to be enrolled. If <code>NULL</code>,
all remaining patients in plan are enrolled. Error may be triggered if
n_patients is greater than remaining patients as planned.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-set_current_time"></a><div class="section">
<h3 id="method-set-current-time-">Method <code>set_current_time()</code><a class="anchor" aria-label="anchor" href="#method-set-current-time-"></a></h3>
<p>set current time of a trial. Any data collected before could not be
changed. private$now should be set after an event is triggered
(through Event class, futility, interim, etc), an arm is added or
removed as a result of an event</p><div class="section">
<h4 id="usage-26">Usage<a class="anchor" aria-label="anchor" href="#usage-26"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">set_current_time</span><span class="op">(</span><span class="va">time</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-11">Arguments<a class="anchor" aria-label="anchor" href="#arguments-11"></a></h4>
<p></p><div class="arguments"><dl><dt><code>time</code></dt>
<dd><p>current calendar time of a trial.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_current_time"></a><div class="section">
<h3 id="method-get-current-time-">Method <code>get_current_time()</code><a class="anchor" aria-label="anchor" href="#method-get-current-time-"></a></h3>
<p>return current time of a trial</p><div class="section">
<h4 id="usage-27">Usage<a class="anchor" aria-label="anchor" href="#usage-27"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_current_time</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_event_tables"></a><div class="section">
<h3 id="method-get-event-tables-">Method <code>get_event_tables()</code><a class="anchor" aria-label="anchor" href="#method-get-event-tables-"></a></h3>
<p>count accumulative number of events (for TTE) or samples (otherwise) over
calendar time (enroll time + tte for TTE, or enroll time + readout otherwise)</p><div class="section">
<h4 id="usage-28">Usage<a class="anchor" aria-label="anchor" href="#usage-28"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_event_tables</span><span class="op">(</span>arms <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-12">Arguments<a class="anchor" aria-label="anchor" href="#arguments-12"></a></h4>
<p></p><div class="arguments"><dl><dt><code>arms</code></dt>
<dd><p>a vector of arms' name on which the event tables are created.
if <code>NULL</code>, all arms in the trial will be used.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_data_lock_time_by_event_number"></a><div class="section">
<h3 id="method-get-data-lock-time-by-event-number-">Method <code>get_data_lock_time_by_event_number()</code><a class="anchor" aria-label="anchor" href="#method-get-data-lock-time-by-event-number-"></a></h3>
<p>given a set of endpoints and target number of events, determine the data
lock time for Event (futility, interim, final (?)). This function does
not change trial object (e.g. rolling back not yet randomized patients after
the found data lock time).</p><div class="section">
<h4 id="usage-29">Usage<a class="anchor" aria-label="anchor" href="#usage-29"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_data_lock_time_by_event_number</span><span class="op">(</span></span>
<span>  <span class="va">endpoints</span>,</span>
<span>  <span class="va">arms</span>,</span>
<span>  <span class="va">target_n_events</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"all"</span>, <span class="st">"any"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-13">Arguments<a class="anchor" aria-label="anchor" href="#arguments-13"></a></h4>
<p></p><div class="arguments"><dl><dt><code>endpoints</code></dt>
<dd><p>character vector. Data lock time is determined by a set
of endpoints.</p></dd>


<dt><code>arms</code></dt>
<dd><p>a vector of arms' name on which number of events will be
counted.</p></dd>


<dt><code>target_n_events</code></dt>
<dd><p>target number of events for each of the
<code>endpoints</code>.</p></dd>


<dt><code>type</code></dt>
<dd><p><code>all</code> if all target number of events are reached.
<code>any</code> if the any target number of events is reached.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>data lock time</p>
</div>
<div class="section">
<h4 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co">## trial$get_data_lock_time_by_event_number(c('pfs','orr'), c(200,500), 'any')</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_data_lock_time_by_calendar_time"></a><div class="section">
<h3 id="method-get-data-lock-time-by-calendar-time-">Method <code>get_data_lock_time_by_calendar_time()</code><a class="anchor" aria-label="anchor" href="#method-get-data-lock-time-by-calendar-time-"></a></h3>
<p>given the calendar time to lock the data, return it with event counts of
each of the endpoints.</p><div class="section">
<h4 id="usage-30">Usage<a class="anchor" aria-label="anchor" href="#usage-30"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_data_lock_time_by_calendar_time</span><span class="op">(</span><span class="va">calendar_time</span>, <span class="va">arms</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-14">Arguments<a class="anchor" aria-label="anchor" href="#arguments-14"></a></h4>
<p></p><div class="arguments"><dl><dt><code>calendar_time</code></dt>
<dd><p>numeric. Calendar time to lock the data</p></dd>


<dt><code>arms</code></dt>
<dd><p>a vector of arms' name on which number of events will be
counted.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>data lock time</p>
</div>
<div class="section">
<h4 id="examples-1">Examples<a class="anchor" aria-label="anchor" href="#examples-1"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code><span><span class="co">## trial$get_data_lock_time_by_calendar_time(20)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_locked_data"></a><div class="section">
<h3 id="method-get-locked-data-">Method <code>get_locked_data()</code><a class="anchor" aria-label="anchor" href="#method-get-locked-data-"></a></h3>
<p>return locked data for an event</p><div class="section">
<h4 id="usage-31">Usage<a class="anchor" aria-label="anchor" href="#usage-31"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_locked_data</span><span class="op">(</span><span class="va">event_name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-15">Arguments<a class="anchor" aria-label="anchor" href="#arguments-15"></a></h4>
<p></p><div class="arguments"><dl><dt><code>event_name</code></dt>
<dd><p>character, event name of which the locked data to be
extracted.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_locked_data_name"></a><div class="section">
<h3 id="method-get-locked-data-name-">Method <code>get_locked_data_name()</code><a class="anchor" aria-label="anchor" href="#method-get-locked-data-name-"></a></h3>
<p>return names of locked data</p><div class="section">
<h4 id="usage-32">Usage<a class="anchor" aria-label="anchor" href="#usage-32"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_locked_data_name</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_event_number"></a><div class="section">
<h3 id="method-get-event-number-">Method <code>get_event_number()</code><a class="anchor" aria-label="anchor" href="#method-get-event-number-"></a></h3>
<p>return number of events at lock time</p><div class="section">
<h4 id="usage-33">Usage<a class="anchor" aria-label="anchor" href="#usage-33"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_event_number</span><span class="op">(</span>event_name <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-16">Arguments<a class="anchor" aria-label="anchor" href="#arguments-16"></a></h4>
<p></p><div class="arguments"><dl><dt><code>event_name</code></dt>
<dd><p>names of triggered events. Use all triggered events
if <code>NULL</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-save_event_time"></a><div class="section">
<h3 id="method-save-event-time-">Method <code>save_event_time()</code><a class="anchor" aria-label="anchor" href="#method-save-event-time-"></a></h3>
<p>save time of a new event.</p><div class="section">
<h4 id="usage-34">Usage<a class="anchor" aria-label="anchor" href="#usage-34"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">save_event_time</span><span class="op">(</span><span class="va">event_time</span>, <span class="va">event_name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-17">Arguments<a class="anchor" aria-label="anchor" href="#arguments-17"></a></h4>
<p></p><div class="arguments"><dl><dt><code>event_time</code></dt>
<dd><p>numeric. Time of new event.</p></dd>


<dt><code>event_name</code></dt>
<dd><p>character. Name of new event.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_event_time"></a><div class="section">
<h3 id="method-get-event-time-">Method <code>get_event_time()</code><a class="anchor" aria-label="anchor" href="#method-get-event-time-"></a></h3>
<p>return event time when triggering a given event</p><div class="section">
<h4 id="usage-35">Usage<a class="anchor" aria-label="anchor" href="#usage-35"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_event_time</span><span class="op">(</span><span class="va">event_name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-18">Arguments<a class="anchor" aria-label="anchor" href="#arguments-18"></a></h4>
<p></p><div class="arguments"><dl><dt><code>event_name</code></dt>
<dd><p>character. Name of event.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-lock_data"></a><div class="section">
<h3 id="method-lock-data-">Method <code>lock_data()</code><a class="anchor" aria-label="anchor" href="#method-lock-data-"></a></h3>
<p>lock data at specific calendar time.
For time-to-event endpoints, their event indicator *_event should be
updated accordingly. Locked data should be stored separately.
DO NOT OVERWRITE/UPDATE private$trial_data! which can lose actual
time-to-event information. For example, a patient may be censored at
the first data lock. However, he may have event being observed in a
later data lock.</p><div class="section">
<h4 id="usage-36">Usage<a class="anchor" aria-label="anchor" href="#usage-36"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">lock_data</span><span class="op">(</span><span class="va">at_calendar_time</span>, <span class="va">event_name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-19">Arguments<a class="anchor" aria-label="anchor" href="#arguments-19"></a></h4>
<p></p><div class="arguments"><dl><dt><code>at_calendar_time</code></dt>
<dd><p>time point to lock trial data</p></dd>


<dt><code>event_name</code></dt>
<dd><p>assign event name as the name of locked data for
future reference.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-event_plot"></a><div class="section">
<h3 id="method-event-plot-">Method <code>event_plot()</code><a class="anchor" aria-label="anchor" href="#method-event-plot-"></a></h3>
<p>plot of cumulative number of events/samples over calendar time.</p><div class="section">
<h4 id="usage-37">Usage<a class="anchor" aria-label="anchor" href="#usage-37"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">event_plot</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-censor_trial_data"></a><div class="section">
<h3 id="method-censor-trial-data-">Method <code>censor_trial_data()</code><a class="anchor" aria-label="anchor" href="#method-censor-trial-data-"></a></h3>
<p>censor trial data at calendar time</p><div class="section">
<h4 id="usage-38">Usage<a class="anchor" aria-label="anchor" href="#usage-38"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">censor_trial_data</span><span class="op">(</span>censor_at <span class="op">=</span> <span class="cn">NULL</span>, selected_arms <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-20">Arguments<a class="anchor" aria-label="anchor" href="#arguments-20"></a></h4>
<p></p><div class="arguments"><dl><dt><code>censor_at</code></dt>
<dd><p>time of censoring. It is set to trial duration if
<code>NULL</code>.</p></dd>


<dt><code>selected_arms</code></dt>
<dd><p>censoring is applied to selected arms (e.g.,
removed arms) only. If <code>NULL</code>, it will be set to all available arms
in trial data. Otherwise, censoring is applied to user-specified arms only.
This is necessary because number of events/sample size in removed arms
should be fixed unchanged since corresponding event is triggered. In that
case, one can update trial data by something like
<code>censor_trial_data(censor_at = event_time, selected_arms = removed_arms)</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-save"></a><div class="section">
<h3 id="method-save-">Method <code><a href="https://rdrr.io/r/base/save.html" class="external-link">save()</a></code><a class="anchor" aria-label="anchor" href="#method-save-"></a></h3>
<p>save a single value or a one-row data frame to trial's output
for further analysis/summary later.</p><div class="section">
<h4 id="usage-39">Usage<a class="anchor" aria-label="anchor" href="#usage-39"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span><span class="va">value</span>, name <span class="op">=</span> <span class="st">""</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-21">Arguments<a class="anchor" aria-label="anchor" href="#arguments-21"></a></h4>
<p></p><div class="arguments"><dl><dt><code>value</code></dt>
<dd><p>value to be saved. It can be a vector (of length 1) or
a data frame (of one row).</p></dd>


<dt><code>name</code></dt>
<dd><p>character to name the saved object. It will be used to
name a column in trial's output if <code>value</code> is a vector.
If <code>value</code> is a data frame, <code>name</code> will be the prefix pasted
with the column name of <code>value</code> in trial's output.
If user want to use
<code>value</code>'s column name as is in trial's output, set <code>name</code>
to be <code>''</code> as default. Otherwise, column name would be, e.g.,
<code>"{name}_&lt;{names(value)}&gt;"</code>.</p></dd>


<dt><code>overwrite</code></dt>
<dd><p>logic. <code>TRUE</code> if overwriting existing entries
with warning, otherwise, throwing an error and stop.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-bind"></a><div class="section">
<h3 id="method-bind-">Method <code>bind()</code><a class="anchor" aria-label="anchor" href="#method-bind-"></a></h3>
<p>row bind a data frame to existing data frame. If <code>name</code> is not
existing in <code>Trial</code>, then it is equivalent to <code>Trial$save</code>.
Extra columns in <code>value</code> are ignored. Columns in
<code>Trial$custom_data[[name]]</code> but not in <code>value</code> are filled
with <code>NA</code>.</p><div class="section">
<h4 id="usage-40">Usage<a class="anchor" aria-label="anchor" href="#usage-40"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">bind</span><span class="op">(</span><span class="va">value</span>, <span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-22">Arguments<a class="anchor" aria-label="anchor" href="#arguments-22"></a></h4>
<p></p><div class="arguments"><dl><dt><code>value</code></dt>
<dd><p>a data frame to be saved. It can consist of one or
multiple rows.</p></dd>


<dt><code>name</code></dt>
<dd><p>character. Name of object to be saved.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-save_custom_data"></a><div class="section">
<h3 id="method-save-custom-data-">Method <code>save_custom_data()</code><a class="anchor" aria-label="anchor" href="#method-save-custom-data-"></a></h3>
<p>save arbitrary (number of) objects into a trial so that users can use
those to control the workflow. Most common use case is to store
simulation parameters to be used in action functions.</p><div class="section">
<h4 id="usage-41">Usage<a class="anchor" aria-label="anchor" href="#usage-41"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">save_custom_data</span><span class="op">(</span><span class="va">value</span>, <span class="va">name</span>, overwrite <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-23">Arguments<a class="anchor" aria-label="anchor" href="#arguments-23"></a></h4>
<p></p><div class="arguments"><dl><dt><code>value</code></dt>
<dd><p>value to be saved. Any type.</p></dd>


<dt><code>name</code></dt>
<dd><p>character. Name of the value to be accessed later.</p></dd>


<dt><code>overwrite</code></dt>
<dd><p>logic. <code>TRUE</code> if overwriting existing entries
with warning, otherwise, throwing an error and stop.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_custom_data"></a><div class="section">
<h3 id="method-get-custom-data-">Method <code>get_custom_data()</code><a class="anchor" aria-label="anchor" href="#method-get-custom-data-"></a></h3>
<p>return saved custom data of specified name.</p><div class="section">
<h4 id="usage-42">Usage<a class="anchor" aria-label="anchor" href="#usage-42"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_custom_data</span><span class="op">(</span><span class="va">name</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-24">Arguments<a class="anchor" aria-label="anchor" href="#arguments-24"></a></h4>
<p></p><div class="arguments"><dl><dt><code>name</code></dt>
<dd><p>character. Name of custom data to be accessed.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_output"></a><div class="section">
<h3 id="method-get-output-">Method <code>get_output()</code><a class="anchor" aria-label="anchor" href="#method-get-output-"></a></h3>
<p>return a data frame of all current outputs saved by calling <code>save</code>.</p><div class="section">
<h4 id="usage-43">Usage<a class="anchor" aria-label="anchor" href="#usage-43"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_output</span><span class="op">(</span>cols <span class="op">=</span> <span class="cn">NULL</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-25">Arguments<a class="anchor" aria-label="anchor" href="#arguments-25"></a></h4>
<p></p><div class="arguments"><dl><dt><code>cols</code></dt>
<dd><p>columns to be returned from <code>Trial$output</code>. If
<code>NULL</code>, all columns are returned.</p></dd>


<dt><code>simplify</code></dt>
<dd><p>logical. Return value rather than a data frame of one
column when <code>length(col) == 1</code> and <code>simplify == TRUE</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-mute"></a><div class="section">
<h3 id="method-mute-">Method <code>mute()</code><a class="anchor" aria-label="anchor" href="#method-mute-"></a></h3>
<p>mute all messages (not including warnings)</p><div class="section">
<h4 id="usage-44">Usage<a class="anchor" aria-label="anchor" href="#usage-44"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">mute</span><span class="op">(</span><span class="va">silent</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-26">Arguments<a class="anchor" aria-label="anchor" href="#arguments-26"></a></h4>
<p></p><div class="arguments"><dl><dt><code>silent</code></dt>
<dd><p>logical.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-set_tester"></a><div class="section">
<h3 id="method-set-tester-">Method <code>set_tester()</code><a class="anchor" aria-label="anchor" href="#method-set-tester-"></a></h3>
<p>set a tester, now it can only be an object of class <code>GraphicalTesting</code>.</p><div class="section">
<h4 id="usage-45">Usage<a class="anchor" aria-label="anchor" href="#usage-45"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">set_tester</span><span class="op">(</span><span class="va">tester</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-27">Arguments<a class="anchor" aria-label="anchor" href="#arguments-27"></a></h4>
<p></p><div class="arguments"><dl><dt><code>tester</code></dt>
<dd><p>object of class <code>GraphicalTesting</code></p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Trial-get_tester"></a><div class="section">
<h3 id="method-get-tester-">Method <code>get_tester()</code><a class="anchor" aria-label="anchor" href="#method-get-tester-"></a></h3>
<p>return a tester, now it is a <code>GraphicalTesting</code> object.</p><div class="section">
<h4 id="usage-46">Usage<a class="anchor" aria-label="anchor" href="#usage-46"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_tester</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-independentIncrement"></a><div class="section">
<h3 id="method-independentincrement-">Method <code>independentIncrement()</code><a class="anchor" aria-label="anchor" href="#method-independentincrement-"></a></h3>
<p>calculate independent increments from a given set of events</p><div class="section">
<h4 id="usage-47">Usage<a class="anchor" aria-label="anchor" href="#usage-47"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">independentIncrement</span><span class="op">(</span><span class="va">endpoint</span>, <span class="va">placebo</span>, <span class="va">events</span>, <span class="va">planned_info</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-28">Arguments<a class="anchor" aria-label="anchor" href="#arguments-28"></a></h4>
<p></p><div class="arguments"><dl><dt><code>endpoint</code></dt>
<dd><p>character. Name of time-to-event endpoint in trial's
locked data.</p></dd>


<dt><code>placebo</code></dt>
<dd><p>character. String of placebo in trial's locked data.</p></dd>


<dt><code>events</code></dt>
<dd><p>a character vector of event names in the trial, e.g.,
<code>listener$get_event_names()</code>.</p></dd>


<dt><code>planned_info</code></dt>
<dd><p>a vector of planned accumulative number of event of
time-to-event endpoint. Note: <code>planned_info</code> can also be a character
<code>"oracle"</code> so that planned number of events are set to be observed
number of events, in that case inverse normal z statistics equal to
one-sided logrank statistics. This is for the purpose of debugging only.
In formal simulation, <code>"oracle"</code> should not be used if adaptation
is present. Pre-fixed <code>planned_info</code> should be used to create
weights in combination test that controls the family-wise error rate
in the strong sense.</p></dd>


<dt><code>...</code></dt>
<dd><p>subset condition that is compatible with <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter</a></code>.
<code>survdiff</code> will be fitted on this subset only to compute one-sided
logrank statistics. It could be useful when a
trial consists of more than two arms. By default it is not specified,
all data will be used to fit the model.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>This function returns a data frame with columns:</p><dl><dt><code>p_inverse_normal</code></dt>
<dd><p>one-sided p-value for inverse normal test
based on logrank test (alternative hypothesis: risk is higher in placebo arm).
Accumulative data is used.</p></dd>

<dt><code>z_inverse_normal</code></dt>
<dd><p>z statistics of <code>p_inverse_normal</code>.
Accumulative data is used.</p></dd>

<dt><code>p_lr</code></dt>
<dd><p>one-sided p-value for logrank test
 (alternative hypothesis: risk is higher in placebo arm).
Accumulative data is used.</p></dd>

<dt><code>z_lr</code></dt>
<dd><p>z statistics of <code>p_lr</code>.
Accumulative data is used.</p></dd>

<dt><code>info</code></dt>
<dd><p>observed accumulative event number.</p></dd>

<dt><code>planned_info</code></dt>
<dd><p>planned accumulative event number.</p></dd>

<dt><code>info_pbo</code></dt>
<dd><p>observed accumulative event number in placebo.</p></dd>

<dt><code>info_trt</code></dt>
<dd><p>observed accumulative event number in treatment arm.</p></dd>

<dt><code>wt</code></dt>
<dd><p>weights in <code>z_inverse_normal</code>.</p></dd>


</dl></div>
<div class="section">
<h4 id="examples-2">Examples<a class="anchor" aria-label="anchor" href="#examples-2"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>
\dontrun{
trial$independentIncrement('pfs', 'pbo', listener$get_event_names(), 'oracle')
}
</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-dunnettTest"></a><div class="section">
<h3 id="method-dunnetttest-">Method <code>dunnettTest()</code><a class="anchor" aria-label="anchor" href="#method-dunnetttest-"></a></h3>
<p>carry out closed test based on Dunnett method under group sequential
design.</p><div class="section">
<h4 id="usage-48">Usage<a class="anchor" aria-label="anchor" href="#usage-48"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">dunnettTest</span><span class="op">(</span><span class="va">endpoint</span>, <span class="va">placebo</span>, <span class="va">treatments</span>, <span class="va">events</span>, <span class="va">planned_info</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-29">Arguments<a class="anchor" aria-label="anchor" href="#arguments-29"></a></h4>
<p></p><div class="arguments"><dl><dt><code>endpoint</code></dt>
<dd><p>character of an endpoint for Dunnett test.</p></dd>


<dt><code>placebo</code></dt>
<dd><p>character. Name of placebo arm.</p></dd>


<dt><code>treatments</code></dt>
<dd><p>character vector. Name of treatment arms to be used in
comparison.</p></dd>


<dt><code>events</code></dt>
<dd><p>character vector. Names of triggered events at which either
adaptation is applied or statistical testing for endpoint is performed.
Event in <code>events</code> does not need to be sorted by their triggering time.</p></dd>


<dt><code>planned_info</code></dt>
<dd><p>a data frame of planned number of events of
time-to-event endpoint in each stage and each arm. Event names, i.e.,
<code>events</code> are row names of <code>planned_info</code>, and arm names, i.e.,
<code>c(placebo, treatments)</code> are column names.
Note that it is not the accumulative but stage-wise event numbers.
It is usually not easy to determine these numbers in practice, simulation
may be used to get estimates.
Note: <code>planned_info</code> can also be a character
<code>"default"</code> so that <code>planned_info</code> are set to be number
of newly randomized patients in the control arm in each of the stages.
This assumes that
event rate do not change over time and/or sample ratio between placebo
and a treatment arm does not change as well, which may not be true.
It is for the purpose of debugging or rapid implementation
only. Using simulation to pick <code>planned_info</code> is recommended in
formal simulation study.</p></dd>


<dt><code>...</code></dt>
<dd><p>subset condition that is compatible with <code><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">dplyr::filter</a></code>.
<code>survdiff</code> will be fitted on this subset only to compute one-sided
logrank statistics. It could be useful when comparison is made on a
subset of treatment arms. By default it is not specified,
all data (placebo plus one treatment arm at a time) in the locked data
are used to fit the model.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h4>
<p>This function computes stage-wise p-values for each of the intersection
hypotheses based on Dunnett test. If only one treatment arm is present,
it is equivalent to compute the stage-wise p-values of elemental
hypotheses. This function also computes inverse normal combination
test statistics at each of the stages.
The choice of <code>planned_info</code> can affect the calculation of
stage-wise p-values. Specifically, it is used to compute
the columns <code>observed_info</code> and <code>p_inverse_normal</code> in returned
data frame, which will be used in <code>Trial$closedTest()</code>.
The choice of <code>planned_info</code> can affect the result of
<code>Trial$closedTest()</code> so user should chose it with caution.</p>
<p>Note that in <code>Trial$closedTest()</code>,
<code>observed_info</code>, which is derived from <code>planned_info</code>, will
lead to the same closed testing results up to a constant. This is because
the closed test uses information fraction
<code>observed_info/sum(observed_info)</code>. As a result, setting
<code>planned_info</code> to, e.g., <code>10 * planned_info</code> should give same
closed test results.</p>
<p>Based on numerical study, setting <code>planned_info = "default"</code> leads
to a much higher power (roughly 10%) than setting <code>planned_info</code> to
median of event numbers at stages, which can be determined by simulation.
I am not sure if regulator would support such practice. For example,
if an event (e.g., interim analysis) is triggered at a pre-specified
calendar time, the number of randomized patients is random and is unknown
when planning the trial. If I understand it correctly, regulator may want
the information fraction in closed test (combined with Dunnett test) to
be pre-fixed. In addition, this choice for <code>planned_info</code> assumes
that the event rates does not change over time which is obviously not
true. It is recommended to always use pre-fixed <code>planned_info</code> for
restrict control of family-wise error rate. It should be pointed out
that the choice of pre-fixed <code>planned_info</code> can affect statistical
power significantly so fine-tuning may be required.</p>
</div>

<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>a list with element names like <code>arm_name</code>,
<code>arm1_name|arm2_name</code>, <code>arm1_name|arm2_name|arm3_name</code>, etc.,
i.e., all possible combination of treatment arms in comparison. Each
element is a data frame, with its column names self-explained. Specifically,
the columns <code>p_inverse_normal</code>, <code>observed_info</code>,
<code>is_final</code> can be used with <code>GroupSequentialTest</code> to perform
significance test.</p>
</div>
<div class="section">
<h4 id="examples-3">Examples<a class="anchor" aria-label="anchor" href="#examples-3"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
trial$dunnettTest('pfs', 'pbo', c('high dose', 'low dose'), listener$get_event_names(), 'default')
}

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-closedTest"></a><div class="section">
<h3 id="method-closedtest-">Method <code>closedTest()</code><a class="anchor" aria-label="anchor" href="#method-closedtest-"></a></h3>
<p>perform closed test based on Dunnett test</p><div class="section">
<h4 id="usage-49">Usage<a class="anchor" aria-label="anchor" href="#usage-49"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">closedTest</span><span class="op">(</span></span>
<span>  <span class="va">dunnett_test</span>,</span>
<span>  <span class="va">treatments</span>,</span>
<span>  <span class="va">events</span>,</span>
<span>  <span class="va">alpha</span>,</span>
<span>  alpha_spending <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"asP"</span>, <span class="st">"asOF"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-30">Arguments<a class="anchor" aria-label="anchor" href="#arguments-30"></a></h4>
<p></p><div class="arguments"><dl><dt><code>dunnett_test</code></dt>
<dd><p>object returned by <code>Trial$dunnettTest()</code>.</p></dd>


<dt><code>treatments</code></dt>
<dd><p>character vector. Name of treatment arms to be used in
comparison.</p></dd>


<dt><code>events</code></dt>
<dd><p>character vector. Names of triggered events at which
significance testing for endpoint is performed in closed test.
Event in <code>events</code> does not need to be sorted by their triggering time.</p></dd>


<dt><code>alpha</code></dt>
<dd><p>numeric. Allocated alpha.</p></dd>


<dt><code>alpha_spending</code></dt>
<dd><p>alpha spending function. It can be <code>"asP"</code> or
<code>"asOF"</code>. Note that theoretically it can be <code>"asUser"</code>, but
it is not tested. It may be supported in the future.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>a data frame of columns <code>arm</code>, <code>decision</code>,
<code>event_at_reject</code>, and <code>reject_time</code>.</p>
</div>
<div class="section">
<h4 id="examples-4">Examples<a class="anchor" aria-label="anchor" href="#examples-4"></a></h4>
<p></p><div class="r example copy"><div class="sourceCode"><pre><code>\dontrun{
dt &lt;- trial$dunnettTest(
  'pfs', 'pbo', c('high dose', 'low dose'),
  listener$get_event_names(), 'default')

trial$closedTest(dt, c('high dose', 'low dose'),
                 c('pfs interim', 'pfs final'),
                 0.025, 'asOF')
}

</code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-get_seed"></a><div class="section">
<h3 id="method-get-seed-">Method <code>get_seed()</code><a class="anchor" aria-label="anchor" href="#method-get-seed-"></a></h3>
<p>return random seed</p><div class="section">
<h4 id="usage-50">Usage<a class="anchor" aria-label="anchor" href="#usage-50"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">get_seed</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>print a trial</p><div class="section">
<h4 id="usage-51">Usage<a class="anchor" aria-label="anchor" href="#usage-51"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-Trial-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-52">Usage<a class="anchor" aria-label="anchor" href="#usage-52"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Trial</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-31">Arguments<a class="anchor" aria-label="anchor" href="#arguments-31"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">risk1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  end_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">26.0</span>, <span class="fl">52.0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  piecewise_risk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.01</span>, <span class="fl">0.381</span>, <span class="fl">0.150</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.01</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">pfs1</span> <span class="op">&lt;-</span> <span class="va"><a href="Endpoint.html">Endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'pfs'</span>, type<span class="op">=</span><span class="st">'tte'</span>,</span></span>
<span class="r-in"><span>          generator <span class="op">=</span> <span class="va">PiecewiseConstantExponentialRNG</span>,</span></span>
<span class="r-in"><span>          risk <span class="op">=</span> <span class="va">risk1</span>, endpoint_name <span class="op">=</span> <span class="st">'pfs'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">orr1</span> <span class="op">&lt;-</span> <span class="va"><a href="Endpoint.html">Endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">'orr'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>,</span></span>
<span class="r-in"><span>  readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>orr<span class="op">=</span><span class="fl">1</span><span class="op">)</span>, generator <span class="op">=</span> <span class="va">rbinom</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">placebo</span> <span class="op">&lt;-</span> <span class="va"><a href="Arm.html">Arm</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">'pbo'</span>, description <span class="op">=</span> <span class="st">'Placebo arm'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">placebo</span><span class="op">$</span><span class="fu">add_endpoints</span><span class="op">(</span><span class="va">pfs1</span>, <span class="va">orr1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">risk2</span> <span class="op">&lt;-</span> <span class="va">risk1</span></span></span>
<span class="r-in"><span><span class="va">risk2</span><span class="op">$</span><span class="va">hazard_ratio</span> <span class="op">&lt;-</span> <span class="fl">.8</span></span></span>
<span class="r-in"><span><span class="va">pfs2</span> <span class="op">&lt;-</span> <span class="va"><a href="Endpoint.html">Endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'pfs'</span>, type<span class="op">=</span><span class="st">'tte'</span>,</span></span>
<span class="r-in"><span>          generator <span class="op">=</span> <span class="va">PiecewiseConstantExponentialRNG</span>,</span></span>
<span class="r-in"><span>          risk <span class="op">=</span> <span class="va">risk2</span>, endpoint_name <span class="op">=</span> <span class="st">'pfs'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">orr2</span> <span class="op">&lt;-</span> <span class="va"><a href="Endpoint.html">Endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">'orr'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>,</span></span>
<span class="r-in"><span>  generator <span class="op">=</span> <span class="va">rbinom</span>, readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>orr<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">active</span> <span class="op">&lt;-</span> <span class="va"><a href="Arm.html">Arm</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">'ac'</span>, description <span class="op">=</span> <span class="st">'Active arm'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">active</span><span class="op">$</span><span class="fu">add_endpoints</span><span class="op">(</span><span class="va">pfs2</span>, <span class="va">orr2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plan a trial, Trial-3415, of up to 100 patients.</span></span></span>
<span class="r-in"><span><span class="co">## Enrollment time follows an exponential distribution, with median 5</span></span></span>
<span class="r-in"><span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va">Trial</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  name <span class="op">=</span> <span class="st">'Trial-3415'</span>, n_patients <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  seed <span class="op">=</span> <span class="fl">31415926</span>, duration <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  enroller <span class="op">=</span> <span class="va">rexp</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">add_arms</span><span class="op">(</span>sample_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, <span class="va">placebo</span>, <span class="va">active</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Arm(s) &lt;pbo, ac&gt; are added to the trial. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Randomization is done for 100 potential patients. </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Data of 100 potential patients are generated for the trial with 2 arm(s) &lt;pbo, ac&gt;. </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$get_data_lock_time_by_event_number`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## trial$get_data_lock_time_by_event_number(c('pfs','orr'), c(200,500), 'any')</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$get_data_lock_time_by_calendar_time`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## trial$get_data_lock_time_by_calendar_time(20)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$independentIncrement`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">independentIncrement</span><span class="op">(</span><span class="st">'pfs'</span>, <span class="st">'pbo'</span>, <span class="va">listener</span><span class="op">$</span><span class="fu">get_event_names</span><span class="op">(</span><span class="op">)</span>, <span class="st">'oracle'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$dunnettTest`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">dunnettTest</span><span class="op">(</span><span class="st">'pfs'</span>, <span class="st">'pbo'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>, <span class="va">listener</span><span class="op">$</span><span class="fu">get_event_names</span><span class="op">(</span><span class="op">)</span>, <span class="st">'default'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Method `Trial$closedTest`</span></span></span>
<span class="r-in"><span><span class="co">## ------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">dunnettTest</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">'pfs'</span>, <span class="st">'pbo'</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="va">listener</span><span class="op">$</span><span class="fu">get_event_names</span><span class="op">(</span><span class="op">)</span>, <span class="st">'default'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">trial</span><span class="op">$</span><span class="fu">closedTest</span><span class="op">(</span><span class="va">dt</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'pfs interim'</span>, <span class="st">'pfs final'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 <span class="fl">0.025</span>, <span class="st">'asOF'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Han Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

