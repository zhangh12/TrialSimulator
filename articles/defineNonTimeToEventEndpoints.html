<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Define Non-Time-to-Event Endpoints in Clinical Trials • TrialSimulator</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Define Non-Time-to-Event Endpoints in Clinical Trials">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TrialSimulator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.51.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adaptiveDesign.html">An Example of Simulating a Trial with Adaptive Design</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons with graphicalMCP and gMCP</a></li>
    <li><a class="dropdown-item" href="../articles/defineNonTimeToEventEndpoints.html">Define Non-Time-to-Event Endpoints in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/defineTimeToEventEndpoints.html">Define Time-to-Event Endpoints in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/designDocument.html">Modular Clinical Trial Simulation: Overview of Core Functions and Workflow</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Define Non-Time-to-Event Endpoints in Clinical Trials</h1>
            
      

      <div class="d-none name"><code>defineNonTimeToEventEndpoints.Rmd</code></div>
    </div>

    
    
<p><code>TrialSimulator</code> provides a flexible framework for
defining and simulating a variety of clinical trial endpoints by
specifying the <code>type</code> parameter in <code>Endpoint$new</code>.
This vignette covers non-time-to-event (non-TTE) endpoints,
demonstrating how they can be defined, integrated into trial arms, and
analyzed at pre-specified event triggers. For time-to-event endpoints,
please refer to the separate vignette <a href="%5Cvignette%7BdefineTimeToEventEndpoints%7D">Define Time-to-Event
Endpoints in Clinical Trials</a>.</p>
<div class="section level2">
<h2 id="define-endpoints-with-random-number-generators-from-stats">Define endpoints with random number generators from
<code>stats</code><a class="anchor" aria-label="anchor" href="#define-endpoints-with-random-number-generators-from-stats"></a>
</h2>
<p>Similar to time-to-event endpoints, non-TTE endpoints can be defined
using any univariate random number generator that takes <code>n</code>
(number of observations) as its first argument. The <code>type</code>
should be set to <code>"non-tte"</code>, and the <code>readout</code>
parameter should be specified as a named numeric vector, indicating the
time required for the endpoint to be available for analysis after
patient enrollment.</p>
<p>In the example below, we define two types of endpoints:</p>
<ul>
<li><p>Continuous endpoint: Tumor size change from baseline
(<code>cfb</code>), available after 6 months.</p></li>
<li><p>Binary endpoint: Objective response rate (<code>orr</code>),
available after 2 months.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## endpoints in placebo arm</span></span>
<span><span class="va">tumor_cfb_pbo</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Endpoint.html">Endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'cfb'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>, </span>
<span>                              readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>cfb <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>                              generator <span class="op">=</span> <span class="va">rnorm</span>, mean <span class="op">=</span> <span class="fl">.8</span>, sd <span class="op">=</span> <span class="fl">3.2</span><span class="op">)</span></span>
<span><span class="va">orr_pbo</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Endpoint.html">Endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'orr'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>, </span>
<span>                        readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>orr <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>                        generator <span class="op">=</span> <span class="va">rbinom</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## define the placebo arm</span></span>
<span><span class="va">pbo</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Arm.html">Arm</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'placebo'</span><span class="op">)</span></span>
<span><span class="va">pbo</span><span class="op">$</span><span class="fu">add_endpoints</span><span class="op">(</span><span class="va">tumor_cfb_pbo</span>, <span class="va">orr_pbo</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## endpoints in treatment arm</span></span>
<span><span class="va">tumor_cfb_trt</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Endpoint.html">Endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'cfb'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>, </span>
<span>                              readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>cfb <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>, </span>
<span>                              generator <span class="op">=</span> <span class="va">rnorm</span>, mean <span class="op">=</span> <span class="op">-</span><span class="fl">2.3</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">orr_trt</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Endpoint.html">Endpoint</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'orr'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>, </span>
<span>                        readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>orr <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>                        generator <span class="op">=</span> <span class="va">rbinom</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">.25</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## define the treatment arm</span></span>
<span><span class="va">trt</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Arm.html">Arm</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'treatment'</span><span class="op">)</span></span>
<span><span class="va">trt</span><span class="op">$</span><span class="fu">add_endpoints</span><span class="op">(</span><span class="va">tumor_cfb_trt</span>, <span class="va">orr_trt</span><span class="op">)</span></span></code></pre></div>
<p>With the treatment arms defined, we can proceed to create a trial.
Patients are recruited at a piecewise constant rate, with an accrual
pattern as follows:</p>
<ul>
<li>First 6 months: 10 patients per month.</li>
<li>After 6 months: 20 patients per month until 420 patients are
randomized 1:1 into the two arms.</li>
</ul>
<p>We also specify a dropout process with a Weibull distribution. The
dropout rates are set as follows:</p>
<ul>
<li>15% dropout at 12 months</li>
<li>30% dropout at 18 months</li>
</ul>
<p>These constraints are resolved using the Weibull dropout
function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mn>0.15</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo></mtd><mtd columnalign="right" style="text-align: right"><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>12</mn><mi>/</mi><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup></mrow></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"><mn>0.30</mn></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo></mtd><mtd columnalign="right" style="text-align: right"><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>18</mn><mi>/</mi><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup></mrow></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{split}
0.15 &amp; = &amp; 1 - e^{-(12/\lambda)^k} \\
0.30 &amp; = &amp; 1 - e^{-(18/\lambda)^k}
\end{split}
</annotation></semantics></math></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dropout_pars</span> <span class="op">&lt;-</span> <span class="fu">weibullDropout</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">18</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.15</span>, <span class="fl">.30</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dropout_pars</span></span>
<span><span class="co">#&gt;     shape     scale </span></span>
<span><span class="co">#&gt;  1.938589 30.635696</span></span></code></pre></div>
<p>Using the computed scale parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">\lambda=</annotation></semantics></math>
30.636 and shape parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo></mrow><annotation encoding="application/x-tex">k=</annotation></semantics></math>
1.939, we specify the trial setup:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">accrual_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>end_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="cn">Inf</span><span class="op">)</span>, </span>
<span>                           piecewise_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Trial.html">Trial</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">'Trial-31415'</span>, description <span class="op">=</span> <span class="st">'Example Clinical Trial'</span>, </span>
<span>  n_patients <span class="op">=</span> <span class="fl">420</span>, duration <span class="op">=</span> <span class="fl">30</span>, </span>
<span>  enroller <span class="op">=</span> <span class="va">StaggeredRecruiter</span>, accrual_rate <span class="op">=</span> <span class="va">accrual_rate</span>, </span>
<span>  dropout <span class="op">=</span> <span class="va">rweibull</span>, scale <span class="op">=</span> <span class="fl">30.636</span>, shape <span class="op">=</span> <span class="fl">1.939</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Seed is not specified. TrialSimulator sets it to 1012203595</span></span>
<span></span>
<span><span class="co">## add arms to the trial</span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">add_arms</span><span class="op">(</span>sample_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">trt</span>, <span class="va">pbo</span><span class="op">)</span></span>
<span><span class="co">#&gt; Arm(s) &lt;treatment, placebo&gt; are added to the trial.</span></span>
<span><span class="co">#&gt; Randomization is done for 420 potential patients.</span></span>
<span><span class="co">#&gt; Data of 420 potential patients are generated for the trial with 2 arm(s) &lt;treatment, placebo&gt;.</span></span>
<span><span class="va">trial</span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB; background-color: #0000BB;"> ⚕⚕ Trial Name:  Trial-31415 </span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB; background-color: #0000BB;"> ⚕⚕ Description:  Example Clinical Trial </span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB; background-color: #0000BB;"> ⚕⚕ # of Arms:  2 </span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB; background-color: #0000BB;"> ⚕⚕ Registered Arms:  treatment, placebo </span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB; background-color: #0000BB;"> ⚕⚕ Sample Ratio:  1, 1 </span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB; background-color: #0000BB;"> ⚕⚕ # of Patients:  420 </span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB; background-color: #0000BB;"> ⚕⚕ Planned Duration:  30 </span> </span></span>
<span><span class="co">#&gt; <span style="color: #BBBBBB; background-color: #0000BB;"> ⚕⚕ Random Seed:  1012203595 </span></span></span></code></pre></div>
<p><code>TrialSimulator</code> allows defining trial events at specific
time points when data is locked for analysis. Here, we define three key
events:</p>
<ol style="list-style-type: decimal">
<li>Interim Analysis: Triggered when <code>orr</code> has been observed
for 60 patients.</li>
<li>Random Checkpoint: Triggered when the trial has reached at least 10
months, and at least one of the following conditions is met:
<ul>
<li>
<code>cfb</code> has been observed for at least 100 patients,</li>
<li>
<code>orr</code> has been observed for at least 180 patients.</li>
</ul>
</li>
<li>Final Analysis: Occurs when the trial reaches 30 months.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interim</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Event.html">Event</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'interim'</span>, </span>
<span>                     trigger_condition <span class="op">=</span> <span class="fu"><a href="../reference/eventNumber.html">eventNumber</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">'orr'</span>, n <span class="op">=</span> <span class="fl">60</span><span class="op">)</span>, </span>
<span>                     action <span class="op">=</span> <span class="va">doNothing</span><span class="op">)</span></span>
<span></span>
<span><span class="va">random</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Event.html">Event</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'random'</span>, </span>
<span>                    trigger_condition <span class="op">=</span> </span>
<span>                      <span class="fu"><a href="../reference/calendarTime.html">calendarTime</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                      <span class="op">(</span><span class="fu"><a href="../reference/eventNumber.html">eventNumber</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">'cfb'</span>, n <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|</span> </span>
<span>                         <span class="fu"><a href="../reference/eventNumber.html">eventNumber</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">'orr'</span>, n <span class="op">=</span> <span class="fl">180</span><span class="op">)</span></span>
<span>                      <span class="op">)</span>, </span>
<span>                    action <span class="op">=</span> <span class="va">doNothing</span><span class="op">)</span></span>
<span></span>
<span><span class="va">final</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Event.html">Event</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">'final'</span>, </span>
<span>                   trigger_condition <span class="op">=</span> <span class="fu"><a href="../reference/calendarTime.html">calendarTime</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, </span>
<span>                   action <span class="op">=</span> <span class="va">doNothing</span><span class="op">)</span></span></code></pre></div>
<p>Here <code>action = doNothing</code> in <code>Event$new</code> means
we don’t expect any action at the time of triggered events. In practice,
instead of <code>doNothing</code>, custom action function can be adopted
to add or remove arms (e.g., dose selection), adjust sample ratio per
arm, or carry out statistical analysis based on locked data. These
advanced setups are covered in other vignettes.</p>
<p>Next, we register the events with a listener and create a controller
to monitor and execute the trial.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## register events to the listener</span></span>
<span><span class="va">listener</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Listener.html">Listener</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">listener</span><span class="op">$</span><span class="fu">add_events</span><span class="op">(</span><span class="va">interim</span>, <span class="va">random</span>, <span class="va">final</span><span class="op">)</span></span>
<span><span class="co">#&gt; An event &lt;interim&gt; is registered.</span></span>
<span><span class="co">#&gt; An event &lt;random&gt; is registered.</span></span>
<span><span class="co">#&gt; An event &lt;final&gt; is registered.</span></span>
<span></span>
<span><span class="co">## run the trial</span></span>
<span><span class="va">controller</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/Controller.html">Controller</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">trial</span>, <span class="va">listener</span><span class="op">)</span></span>
<span><span class="va">controller</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Conditioin of event &lt;interim&gt; is being checked.</span></span>
<span><span class="co">#&gt; Data is locked at time = 8 for event &lt;interim&gt;.</span></span>
<span><span class="co">#&gt; Locked data can be accessed in Trial$get_locked_data('interim'). </span></span>
<span><span class="co">#&gt; Number of events at lock time:</span></span>
<span><span class="co">#&gt;   patient cfb orr                 arms</span></span>
<span><span class="co">#&gt; 1     100  19  60 &lt;treatment, placebo&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditioin of event &lt;random&gt; is being checked.</span></span>
<span><span class="co">#&gt; Data is locked at time = 14.05 for event &lt;random&gt;.</span></span>
<span><span class="co">#&gt; Locked data can be accessed in Trial$get_locked_data('random'). </span></span>
<span><span class="co">#&gt; Number of events at lock time:</span></span>
<span><span class="co">#&gt;   patient cfb orr                 arms</span></span>
<span><span class="co">#&gt; 1     221  97 180 &lt;treatment, placebo&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Conditioin of event &lt;final&gt; is being checked.</span></span>
<span><span class="co">#&gt; Data is locked at time = 30 for event &lt;final&gt;.</span></span>
<span><span class="co">#&gt; Locked data can be accessed in Trial$get_locked_data('final'). </span></span>
<span><span class="co">#&gt; Number of events at lock time:</span></span>
<span><span class="co">#&gt;   patient cfb orr                 arms</span></span>
<span><span class="co">#&gt; 1     420 404 418 &lt;treatment, placebo&gt;</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p><img src="defineNonTimeToEventEndpoints_files/figure-html/ihhf-1.png" width="100%"></p>
<p>We can inspect the dataset locked at different event points:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">interim_data</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">get_locked_data</span><span class="op">(</span><span class="st">'interim'</span><span class="op">)</span></span>
<span><span class="va">random_data</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">get_locked_data</span><span class="op">(</span><span class="st">'random'</span><span class="op">)</span></span>
<span><span class="va">final_data</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">get_locked_data</span><span class="op">(</span><span class="st">'final'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">interim_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient_id       arm enroll_time dropout_time        cfb cfb_readout orr</span></span>
<span><span class="co">#&gt; 1          1   placebo         0.1    27.379476 -1.6573976           6   0</span></span>
<span><span class="co">#&gt; 2          2 treatment         0.2     5.663727         NA           6   0</span></span>
<span><span class="co">#&gt; 3          3 treatment         0.3    41.049509 -3.3811315           6   0</span></span>
<span><span class="co">#&gt; 4          4   placebo         0.4    27.123540  6.0935974           6   0</span></span>
<span><span class="co">#&gt; 5          5   placebo         0.5    31.826353  0.3302882           6   0</span></span>
<span><span class="co">#&gt; 6          6 treatment         0.6    14.416298 -1.6142302           6   0</span></span>
<span><span class="co">#&gt;   orr_readout</span></span>
<span><span class="co">#&gt; 1           2</span></span>
<span><span class="co">#&gt; 2           2</span></span>
<span><span class="co">#&gt; 3           2</span></span>
<span><span class="co">#&gt; 4           2</span></span>
<span><span class="co">#&gt; 5           2</span></span>
<span><span class="co">#&gt; 6           2</span></span></code></pre></div>
<p>Since <code>cfb</code> has a 6-month readout time, at interim
analysis, some patients’ <code>cfb</code> values are still unavailable,
appearing as <code>NA</code> in <code>interim_data.</code> However,
these values become available in <code>random_data</code> collected at a
later time point. This demonstrates how <code>TrialSimulator</code>
properly and automatically handles endpoint availability at different
event triggers.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">not_ready_at_interim</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">interim_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cfb</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">orr</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                  <span class="va">enroll_time</span> <span class="op">+</span> <span class="fl">6</span> <span class="op">&lt;</span> <span class="va">dropout_time</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient_id       arm enroll_time dropout_time cfb cfb_readout orr orr_readout</span></span>
<span><span class="co">#&gt; 1         62   placebo        6.10     26.44169  NA           6  NA           2</span></span>
<span><span class="co">#&gt; 2         64   placebo        6.20     25.48133  NA           6  NA           2</span></span>
<span><span class="co">#&gt; 3         65   placebo        6.25     84.56996  NA           6  NA           2</span></span>
<span><span class="co">#&gt; 4         66 treatment        6.30     31.77506  NA           6  NA           2</span></span>
<span><span class="co">#&gt; 5         67   placebo        6.35     54.47068  NA           6  NA           2</span></span>
<span><span class="co">#&gt; 6         68 treatment        6.40     17.77371  NA           6  NA           2</span></span>
<span></span>
<span><span class="va">random_data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">patient_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">not_ready_at_interim</span><span class="op">$</span><span class="va">patient_id</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patient_id       arm enroll_time dropout_time        cfb cfb_readout orr</span></span>
<span><span class="co">#&gt; 1         62   placebo        6.10     26.44169  1.5471692           6   0</span></span>
<span><span class="co">#&gt; 2         64   placebo        6.20     25.48133 -3.1648153           6   0</span></span>
<span><span class="co">#&gt; 3         65   placebo        6.25     84.56996 -3.9319150           6   0</span></span>
<span><span class="co">#&gt; 4         66 treatment        6.30     31.77506 -0.9111168           6   0</span></span>
<span><span class="co">#&gt; 5         67   placebo        6.35     54.47068  1.1369365           6   0</span></span>
<span><span class="co">#&gt; 6         68 treatment        6.40     17.77371 -0.7169747           6   0</span></span>
<span><span class="co">#&gt;   orr_readout</span></span>
<span><span class="co">#&gt; 1           2</span></span>
<span><span class="co">#&gt; 2           2</span></span>
<span><span class="co">#&gt; 3           2</span></span>
<span><span class="co">#&gt; 4           2</span></span>
<span><span class="co">#&gt; 5           2</span></span>
<span><span class="co">#&gt; 6           2</span></span></code></pre></div>
<p>In this example, we simulate tumor size change from baseline
(<code>cfb</code>). However, in many trials, it is more appropriate to
simulate tumor size at both baseline and follow-up separately to allow
for more complex modeling, such as longitudinal or repeated measures
analysis. This will be covered in another vignette.</p>
<p>With this flexible setup, <code>TrialSimulator</code> enables
efficient endpoint definition, adaptive trial execution, and data
monitoring—allowing users to design and simulate clinical trials
tailored to specific research needs.</p>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Han Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
