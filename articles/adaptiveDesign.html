<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>An Example of Simulating a Trial with Adaptive Design • TrialSimulator</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="An Example of Simulating a Trial with Adaptive Design">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">TrialSimulator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/actionFunctions.html">Specify Actions to Execute at Trial Milestones</a></li>
    <li><a class="dropdown-item" href="../articles/adaptiveDesign.html">An Example of Simulating a Trial with Adaptive Design</a></li>
    <li><a class="dropdown-item" href="../articles/conditionSystem.html">Condition System for Triggering Milestones in a Trial</a></li>
    <li><a class="dropdown-item" href="../articles/defineArms.html">Define and Summarize Arms in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/defineLongitudinalEndpoints.html">Define Longitudinal Endpoints in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/defineNonTimeToEventEndpoints.html">Define Non-Time-to-Event Endpoints in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/defineTimeToEventEndpoints.html">Define Time-to-Event Endpoints in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/fixedDesign.html">An Example of Fixed Design with Two Correlated Endpoints</a></li>
    <li><a class="dropdown-item" href="../articles/responseAdaptive.html">Designs with Response-Adaptive Randomization</a></li>
    <li><a class="dropdown-item" href="../articles/simulatePfsAndOs.html">Simulate Correlated Progression-Free Survival and Overall Survival as Endpoints in Clinical Trials</a></li>
    <li><a class="dropdown-item" href="../articles/wrappers.html">Wrapper Functions of Common Statistical Methods in TrialSimulator</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/zhangh12/TrialSimulator/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="adaptiveDesign_files/kePrint-0.0.1/kePrint.js"></script><link href="adaptiveDesign_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>An Example of Simulating a Trial with Adaptive Design</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/zhangh12/TrialSimulator/blob/v1.0.0/vignettes/adaptiveDesign.Rmd" class="external-link"><code>vignettes/adaptiveDesign.Rmd</code></a></small>
      <div class="d-none name"><code>adaptiveDesign.Rmd</code></div>
    </div>

    
    
<p>In this vignette, we illustrate how to use
<code>TrialSimulator</code> to simulate a trial with seamless adaptive
design of multiple endpoints, where dose selection, futility analysis,
interim analysis are triggered by user-defined milestones. Family-wise
error rate are controlled by closed test with Dunnett’s test, with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
split for the endpoints. Please refer to another vignette where
graphical testing procedure is adopted instead.</p>
<div class="section level2">
<h2 id="simulation-settings">Simulation Settings<a class="anchor" aria-label="anchor" href="#simulation-settings"></a>
</h2>
<ul>
<li>Trial consists of two active arms of high or low dose, and a placebo
arm.</li>
<li>Patients are randomized into the trial with ratio
<code>1:1:1</code>.</li>
<li>30 patients are randomized per month for the first 10 months, and 50
patients per month after then until 1000 patients.</li>
<li>Dropout rate is 8% at month 12, and 18% at month 18, which is
modeled by a Weibull distribution. The scale and shape parameters of the
Weibull distribution can be computed using helper function</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/weibullDropout.html">weibullDropout</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">18</span><span class="op">)</span>, dropout_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.08</span>, <span class="fl">.18</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     shape     scale </span></span>
<span><span class="co">#&gt;  2.138567 38.343517</span></span></code></pre></div>
<ul>
<li>Two time-to-event endpoints (<code>PFS</code> and <code>OS</code>)
and a binary <code>surrogate</code> are under consideration, where a
higher rate of <code>surrogate</code> is better.</li>
<li>
<code>surrogate</code> has a readout time of 5 weeks.</li>
<li>
<code>surrogate</code> is used for dose selection using a
hypothetical rule. Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>h</mi></msub><annotation encoding="application/x-tex">z_h</annotation></semantics></math>
(or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>z</mi><mi>l</mi></msub><annotation encoding="application/x-tex">z_l</annotation></semantics></math>)
be the z statistics of <code>surrogate</code> between high (or low) dose
and placebo.
<ul>
<li>low dose arm is selected if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>l</mi></msub><mo>&gt;</mo><mn>1.28</mn></mrow><annotation encoding="application/x-tex">z_l &gt; 1.28</annotation></semantics></math>;</li>
<li>high dose arm is selected if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>z</mi><mi>h</mi></msub><mo>&gt;</mo><mn>1.28</mn><mo>&gt;</mo><msub><mi>z</mi><mi>l</mi></msub></mrow><annotation encoding="application/x-tex">z_h &gt; 1.28 &gt; z_l</annotation></semantics></math>;</li>
<li>keep both arms otherwise.</li>
</ul>
</li>
<li>Rates of <code>surrogate</code> are
<ul>
<li>0.05 in placebo</li>
<li>0.12 in low dose arm</li>
<li>0.13 in high dose arm</li>
</ul>
</li>
<li>Medians of PFS are
<ul>
<li>5 months in placebo</li>
<li>6.7 months in low dose arm (hazard ratio 0.75)</li>
<li>7.1 months in high dose arm (hazard ratio 0.70) Exponential
distribution is assumed.</li>
</ul>
</li>
<li>Medians of OS are
<ul>
<li>14 months in placebo</li>
<li>17.5 months in low dose arm (hazard ratio 0.80)</li>
<li>18.2 months high dose arms (hazard ratio 0.77)</li>
</ul>
</li>
<li>Dose selection is done when 300 patients are randomized with readout
of <code>surrogate</code> are ready for analysis.</li>
<li>An interim is set to test <code>PFS</code> when 300 <code>PFS</code>
events are observed. A non-binding futility analysis is also done with a
boundary 0.5.</li>
<li>Final analysis is set for <code>PFS</code> and <code>OS</code> when
all planned 1000 patients are randomized and at least 300
<code>OS</code> events are observed. Meanwhile, the trial has reached at
least 28 months or at least 520 events are observed for
<code>PFS</code>.</li>
<li>To control the family-wise error rate accounting for
<code>PFS</code> and <code>OS</code>, as well as adaptation of
dose-selection, we split
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
between <code>PFS</code> (0.5%) and <code>OS</code> (2%), and adopt
closed test with Dunnett’s test for intersection hypotheses.</li>
</ul>
</div>
<div class="section level2">
<h2 id="define-three-arms">Define Three Arms<a class="anchor" aria-label="anchor" href="#define-three-arms"></a>
</h2>
<p>In this example, we call <code><a href="../reference/endpoint.html">endpoint()</a></code> twice for each arm
to define <code>PFS</code> and <code>OS</code>. This implicitly assumes
independence between the two time-to-event endpoints.
<code>TrialSimulator</code> offers a built-in generator
<code><a href="../reference/CorrelatedPfsAndOs3.html">CorrelatedPfsAndOs3()</a></code> to generate <code>PFS</code> and
<code>OS</code> with correlation based on the ill-death model, which
enjoys several nice properties. For selection of its arguments (i.e. 
transition hazards), refer to vignette <a href="simulatePfsAndOs.html">Simulate Correlated Progression-Free
Survival and Overall Survival as Endpoints in Clinical Trials</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' define three arms</span></span>
<span><span class="va">pbo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arm.html">arm</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'placebo'</span><span class="op">)</span></span>
<span><span class="va">low</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arm.html">arm</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'low dose'</span><span class="op">)</span></span>
<span><span class="va">high</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/arm.html">arm</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'high dose'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' define endpoints in placebo</span></span>
<span><span class="va">pfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'pfs'</span>, type <span class="op">=</span> <span class="st">'tte'</span>,</span>
<span>                generator <span class="op">=</span> <span class="va">rexp</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">os</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'os'</span>, type <span class="op">=</span> <span class="st">'tte'</span>,</span>
<span>               generator <span class="op">=</span> <span class="va">rexp</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">14</span><span class="op">)</span></span>
<span></span>
<span><span class="va">five_weeks</span> <span class="op">&lt;-</span> <span class="fl">5</span> <span class="op">/</span> <span class="fl">52</span> <span class="op">*</span> <span class="fl">12</span> <span class="co">## convert it in months</span></span>
<span><span class="va">surrogate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'surrogate'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>,</span>
<span>                      readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>surrogate <span class="op">=</span> <span class="va">five_weeks</span><span class="op">)</span>,</span>
<span>                      generator <span class="op">=</span> <span class="va">rbinom</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="va">pbo</span><span class="op">$</span><span class="fu">add_endpoints</span><span class="op">(</span><span class="va">pfs</span>, <span class="va">os</span>, <span class="va">surrogate</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' define endpoints in low dose arm</span></span>
<span><span class="va">pfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'pfs'</span>, type <span class="op">=</span> <span class="st">'tte'</span>,</span>
<span>                generator <span class="op">=</span> <span class="va">rexp</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">6.7</span><span class="op">)</span></span>
<span></span>
<span><span class="va">os</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'os'</span>, type <span class="op">=</span> <span class="st">'tte'</span>,</span>
<span>               generator <span class="op">=</span> <span class="va">rexp</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">17.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">surrogate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'surrogate'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>,</span>
<span>                      readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>surrogate <span class="op">=</span> <span class="va">five_weeks</span><span class="op">)</span>,</span>
<span>                      generator <span class="op">=</span> <span class="va">rbinom</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">.12</span><span class="op">)</span></span>
<span><span class="va">low</span><span class="op">$</span><span class="fu">add_endpoints</span><span class="op">(</span><span class="va">pfs</span>, <span class="va">os</span>, <span class="va">surrogate</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#' define endpoints in high dose arm</span></span>
<span><span class="va">pfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'pfs'</span>, type <span class="op">=</span> <span class="st">'tte'</span>,</span>
<span>                generator <span class="op">=</span> <span class="va">rexp</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">7.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">os</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'os'</span>, type <span class="op">=</span> <span class="st">'tte'</span>,</span>
<span>               generator <span class="op">=</span> <span class="va">rexp</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">18.2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">surrogate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/endpoint.html">endpoint</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'surrogate'</span>, type <span class="op">=</span> <span class="st">'non-tte'</span>,</span>
<span>                      readout <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>surrogate <span class="op">=</span> <span class="va">five_weeks</span><span class="op">)</span>,</span>
<span>                      generator <span class="op">=</span> <span class="va">rbinom</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fl">.13</span><span class="op">)</span></span>
<span><span class="va">high</span><span class="op">$</span><span class="fu">add_endpoints</span><span class="op">(</span><span class="va">pfs</span>, <span class="va">os</span>, <span class="va">surrogate</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="define-a-trial">Define a Trial<a class="anchor" aria-label="anchor" href="#define-a-trial"></a>
</h2>
<p>With three arms, we can define a trial of class <code>Trial</code>.
Recruitment curve are specified through <code>enroller</code> with a
built-in function <code>StaggeredRecruiter</code> of piecewise constant
rate. We set <code>duration</code> to be an arbitrary large number (50)
but controlling the end of trial through pre-defined milestones later.
Note that if <code>seed = NULL</code>, <code>TrialSimulator</code> will
pick a seed for the purpose of reproducibility.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">accrual_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>end_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                           piecewise_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">trial</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trial.html">trial</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">'Trial-3415'</span>, n_patients <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">1727811904</span>, duration <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  enroller <span class="op">=</span> <span class="va">StaggeredRecruiter</span>, accrual_rate <span class="op">=</span> <span class="va">accrual_rate</span>,</span>
<span>  dropout <span class="op">=</span> <span class="va">rweibull</span>, shape <span class="op">=</span> <span class="fl">2.139</span>, scale <span class="op">=</span> <span class="fl">38.343</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">trial</span><span class="op">$</span><span class="fu">add_arms</span><span class="op">(</span>sample_ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">low</span>, <span class="va">high</span>, <span class="va">pbo</span><span class="op">)</span></span>
<span><span class="co">#&gt; Arm(s) &lt;low dose, high dose, placebo&gt; are added to the trial.</span></span>
<span><span class="co">#&gt; Randomization is done for 1000 potential patients.</span></span>
<span><span class="co">#&gt; Data of 1000 potential patients are generated for the trial with 3 arm(s) &lt;low dose, high dose, placebo&gt;.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="define-trial-milestones-and-action-functions">Define Trial Milestones and Action Functions<a class="anchor" aria-label="anchor" href="#define-trial-milestones-and-action-functions"></a>
</h2>
<p>Next, we define action functions for trial milestones, i.e., dose
selection, interim and final analysis. Note that an action function
should always has arguments <code>trial</code> of class
<code>Trial</code> and a character <code>milestone_name</code>. We
calculate z statistics of the Farrington-Manning test for binary
endpoint <code>surrogate</code> using helper function
<code>fitFarringtonManning</code>, which returns a data frame (see
<code><a href="../reference/fitFarringtonManning.html">?fitFarringtonManning</a></code>).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">action1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">trial</span>, <span class="va">milestone_name</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">locked_data</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">get_locked_data</span><span class="op">(</span><span class="va">milestone_name</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitFarringtonManning.html">fitFarringtonManning</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">'surrogate'</span>, placebo <span class="op">=</span> <span class="st">'placebo'</span>,</span>
<span>                              data <span class="op">=</span> <span class="va">locked_data</span>, alternative <span class="op">=</span> <span class="st">'greater'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># browser() ## if you want to see what does fit look like</span></span>
<span>  <span class="va">z_l</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">z</span><span class="op">[</span><span class="va">fit</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">'low dose'</span><span class="op">]</span></span>
<span>  <span class="va">z_h</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">z</span><span class="op">[</span><span class="va">fit</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">'high dose'</span><span class="op">]</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">z_l</span> <span class="op">&gt;</span> <span class="fl">1.28</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">trial</span><span class="op">$</span><span class="fu">remove_arms</span><span class="op">(</span><span class="st">'high dose'</span><span class="op">)</span></span>
<span>    <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="st">'low'</span>, name <span class="op">=</span> <span class="st">'kept_arm'</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span> <span class="kw">if</span><span class="op">(</span><span class="va">z_h</span> <span class="op">&gt;</span> <span class="fl">1.28</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">trial</span><span class="op">$</span><span class="fu">remove_arms</span><span class="op">(</span><span class="st">'low dose'</span><span class="op">)</span></span>
<span>    <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="st">'high'</span>, name <span class="op">=</span> <span class="st">'kept_arm'</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="st">'both'</span>, name <span class="op">=</span> <span class="st">'kept_arm'</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>At the interim, we test <code>PFS</code> using the logrank test to
carry out a non-binding futility analysis in the following action
function. Depending on how many arms are carried forward in dose
selection, <code>fit</code> may consists of testing results of one or
two dose arms. Note that a formal test for <code>PFS</code> will be done
at the end of the trial when we have all p-values. If no futility
analysis is planned, we can simply set <code>action = doNothing</code>
in <code>milestone</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">action2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">trial</span>, <span class="va">milestone_name</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">locked_data</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">get_locked_data</span><span class="op">(</span><span class="va">milestone_name</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitLogrank.html">fitLogrank</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">pfs</span>, <span class="va">pfs_event</span><span class="op">)</span> <span class="op">~</span> <span class="va">arm</span>, placebo <span class="op">=</span> <span class="st">'placebo'</span>, </span>
<span>                    data <span class="op">=</span> <span class="va">locked_data</span>, alternative <span class="op">=</span> <span class="st">'less'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## futility analysis</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">z</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">.5</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="st">'negative'</span>, name <span class="op">=</span> <span class="st">'futility'</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co">## extend duration</span></span>
<span>    <span class="co">## trial$set_duration(45)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="st">'positive'</span>, name <span class="op">=</span> <span class="st">'futility'</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>At final analysis, we conduct a closed test using Dunnett’s test for
intersection hypotheses. The action function is as follows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">action3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">trial</span>, <span class="va">milestone_name</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">locked_data</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">get_locked_data</span><span class="op">(</span><span class="va">milestone_name</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## test PFS</span></span>
<span>  <span class="va">dt_pfs</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">dunnettTest</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">pfs</span>, <span class="va">pfs_event</span><span class="op">)</span> <span class="op">~</span> <span class="va">arm</span>, placebo <span class="op">=</span> <span class="st">'placebo'</span>,</span>
<span>                              treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span>
<span>                              milestones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dose selection'</span>, <span class="st">'interim'</span>, <span class="st">'final'</span><span class="op">)</span>,</span>
<span>                              alternative <span class="op">=</span> <span class="st">'less'</span>,</span>
<span>                              planned_info <span class="op">=</span> <span class="st">'default'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ct_pfs</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">closedTest</span><span class="op">(</span><span class="va">dt_pfs</span>, treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span>
<span>                             milestones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'interim'</span>, <span class="st">'final'</span><span class="op">)</span>,</span>
<span>                             alpha <span class="op">=</span> <span class="fl">.005</span>, alpha_spending <span class="op">=</span> <span class="st">'asOF'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co">## test OS</span></span>
<span>  <span class="va">dt_os</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">dunnettTest</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">os</span>, <span class="va">os_event</span><span class="op">)</span> <span class="op">~</span> <span class="va">arm</span>, placebo <span class="op">=</span> <span class="st">'placebo'</span>,</span>
<span>                             treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span>
<span>                             milestones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dose selection'</span>, <span class="st">'final'</span><span class="op">)</span>,</span>
<span>                             alternative <span class="op">=</span> <span class="st">'less'</span>, </span>
<span>                             planned_info <span class="op">=</span> <span class="st">'default'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">ct_os</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">closedTest</span><span class="op">(</span><span class="va">dt_pfs</span>, treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span>
<span>                            milestones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'final'</span><span class="op">)</span>,</span>
<span>                            alpha <span class="op">=</span> <span class="fl">.02</span>, alpha_spending <span class="op">=</span> <span class="st">'asOF'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co">## we only save testing decision here</span></span>
<span>  <span class="co">## You can save whatever you want for summarizing things later, e.g. reject time</span></span>
<span>  <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="va">ct_pfs</span><span class="op">$</span><span class="va">decision</span><span class="op">[</span><span class="va">ct_pfs</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">'high dose'</span><span class="op">]</span>, </span>
<span>             name <span class="op">=</span> <span class="st">'pfs_high_dose_decision'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="va">ct_pfs</span><span class="op">$</span><span class="va">decision</span><span class="op">[</span><span class="va">ct_pfs</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">'low dose'</span><span class="op">]</span>, </span>
<span>             name <span class="op">=</span> <span class="st">'pfs_low_dose_decision'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="va">ct_os</span><span class="op">$</span><span class="va">decision</span><span class="op">[</span><span class="va">ct_os</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">'high dose'</span><span class="op">]</span>, </span>
<span>             name <span class="op">=</span> <span class="st">'os_high_dose_decision'</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">trial</span><span class="op">$</span><span class="fu">save</span><span class="op">(</span>value <span class="op">=</span> <span class="va">ct_os</span><span class="op">$</span><span class="va">decision</span><span class="op">[</span><span class="va">ct_os</span><span class="op">$</span><span class="va">arm</span> <span class="op">==</span> <span class="st">'low dose'</span><span class="op">]</span>, </span>
<span>             name <span class="op">=</span> <span class="st">'os_low_dose_decision'</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Next, we register three trial milestones to a listener</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dose_selection</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/milestone.html">milestone</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'dose selection'</span>, action <span class="op">=</span> <span class="va">action1</span>,   </span>
<span>                            when <span class="op">=</span> <span class="fu"><a href="../reference/eventNumber.html">eventNumber</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">'surrogate'</span>, n <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span>                            <span class="op">)</span></span>
<span></span>
<span><span class="va">interim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/milestone.html">milestone</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'interim'</span>, action <span class="op">=</span> <span class="va">action2</span>, </span>
<span>                     when <span class="op">=</span> <span class="fu"><a href="../reference/eventNumber.html">eventNumber</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">'pfs'</span>, n <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span>                     <span class="op">)</span></span>
<span></span>
<span><span class="va">final</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/milestone.html">milestone</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">'final'</span>, action <span class="op">=</span> <span class="va">action3</span>, </span>
<span>                   when <span class="op">=</span> <span class="fu"><a href="../reference/enrollment.html">enrollment</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, arms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'placebo'</span>, <span class="st">'low dose'</span>, <span class="st">'high dose'</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                     <span class="fu"><a href="../reference/eventNumber.html">eventNumber</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">'os'</span>, n <span class="op">=</span> <span class="fl">300</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span></span>
<span>                       <span class="fu"><a href="../reference/calendarTime.html">calendarTime</a></span><span class="op">(</span>time <span class="op">=</span> <span class="fl">28</span><span class="op">)</span> <span class="op">|</span> </span>
<span>                         <span class="fu"><a href="../reference/eventNumber.html">eventNumber</a></span><span class="op">(</span>endpoint <span class="op">=</span> <span class="st">'pfs'</span>, n <span class="op">=</span> <span class="fl">520</span><span class="op">)</span></span>
<span>                       <span class="op">)</span></span>
<span>                   <span class="op">)</span></span>
<span></span>
<span><span class="va">listener</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/listener.html">listener</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#' register milestones with listener</span></span>
<span><span class="va">listener</span><span class="op">$</span><span class="fu">add_milestones</span><span class="op">(</span></span>
<span>  <span class="va">dose_selection</span>,</span>
<span>  <span class="va">interim</span>,</span>
<span>  <span class="va">final</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; A milestone &lt;dose selection&gt; is registered.</span></span>
<span><span class="co">#&gt; A milestone &lt;interim&gt; is registered.</span></span>
<span><span class="co">#&gt; A milestone &lt;final&gt; is registered.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="execute-a-trial">Execute a Trial<a class="anchor" aria-label="anchor" href="#execute-a-trial"></a>
</h2>
<p>We can run a trial as follows. By default,
<code>TrialSimulator</code> generates a plot showing cumulative number
of patients or endpoint events over time for each of the arms. We can
set it to <code>FALSE</code> if a massive number of simulation
replicates is run to save time.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">controller</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/controller.html">controller</a></span><span class="op">(</span><span class="va">trial</span>, <span class="va">listener</span><span class="op">)</span></span>
<span><span class="va">controller</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>plot_event <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Condition of milestone &lt;dose selection&gt; is being checked.</span></span>
<span><span class="co">#&gt; Data is locked at time = 11.1205128205128 for milestone &lt;dose selection&gt;.</span></span>
<span><span class="co">#&gt; Locked data can be accessed in Trial$get_locked_data('dose selection'). </span></span>
<span><span class="co">#&gt; Number of events at lock time:</span></span>
<span><span class="co">#&gt;   patient pfs os surrogate         arms</span></span>
<span><span class="co">#&gt; 1     357 141 65       300 c(119, 4....</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Arm &lt;high dose&gt; is removed.</span></span>
<span><span class="co">#&gt; Sample ratio is updated to be &lt;low dose: 1, placebo: 1&gt;.</span></span>
<span><span class="co">#&gt; Trial data is rolling back to time = 11.1205128205128. </span></span>
<span><span class="co">#&gt; Randomization will be carried out again for unenrolled patients.</span></span>
<span><span class="co">#&gt; Randomization is done for 643 potential patients.</span></span>
<span><span class="co">#&gt; Data of 643 potential patients are generated for the trial with 2 arm(s) &lt;low dose, placebo&gt;.</span></span>
<span><span class="co">#&gt; Condition of milestone &lt;interim&gt; is being checked.</span></span>
<span><span class="co">#&gt; Data is locked at time = 17.9949397642942 for milestone &lt;interim&gt;.</span></span>
<span><span class="co">#&gt; Locked data can be accessed in Trial$get_locked_data('interim'). </span></span>
<span><span class="co">#&gt; Number of events at lock time:</span></span>
<span><span class="co">#&gt;   patient pfs  os surrogate         arms</span></span>
<span><span class="co">#&gt; 1     581 300 138       524 c(290, 1....</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Condition of milestone &lt;final&gt; is being checked.</span></span>
<span><span class="co">#&gt; Data is locked at time = 25.7475563250256 for milestone &lt;final&gt;.</span></span>
<span><span class="co">#&gt; Locked data can be accessed in Trial$get_locked_data('final'). </span></span>
<span><span class="co">#&gt; Number of events at lock time:</span></span>
<span><span class="co">#&gt;   patient pfs  os surrogate         arms</span></span>
<span><span class="co">#&gt; 1     881 596 300       880 c(441, 2....</span></span>
<span><span class="co">#&gt; </span></span></code></pre></div>
<p><img src="adaptiveDesign_files/figure-html/eiaaf-1.png" width="100%"></p>
<p>In custom action functions, we can use <code>Trial$save()</code> to
save intermediate results for summary purpose, which can be accessed
anytime and anywhere by</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">controller</span><span class="op">$</span><span class="fu">get_output</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, </span>
<span>                full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">scroll_box</span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;">
trial
</th>
<th style="text-align:right;">
seed
</th>
<th style="text-align:right;">
milestone_time_&lt;dose selection&gt;
</th>
<th style="text-align:right;">
n_events_&lt;dose selection&gt;_&lt;patient_id&gt;
</th>
<th style="text-align:right;">
n_events_&lt;dose selection&gt;_&lt;pfs&gt;
</th>
<th style="text-align:right;">
n_events_&lt;dose selection&gt;_&lt;os&gt;
</th>
<th style="text-align:right;">
n_events_&lt;dose selection&gt;_&lt;surrogate&gt;
</th>
<th style="text-align:left;">
n_events_&lt;dose selection&gt;_&lt;arms&gt;
</th>
<th style="text-align:left;">
kept_arm
</th>
<th style="text-align:right;">
milestone_time_&lt;interim&gt;
</th>
<th style="text-align:right;">
n_events_&lt;interim&gt;_&lt;patient_id&gt;
</th>
<th style="text-align:right;">
n_events_&lt;interim&gt;_&lt;pfs&gt;
</th>
<th style="text-align:right;">
n_events_&lt;interim&gt;_&lt;os&gt;
</th>
<th style="text-align:right;">
n_events_&lt;interim&gt;_&lt;surrogate&gt;
</th>
<th style="text-align:left;">
n_events_&lt;interim&gt;_&lt;arms&gt;
</th>
<th style="text-align:left;">
futility
</th>
<th style="text-align:right;">
milestone_time_&lt;final&gt;
</th>
<th style="text-align:right;">
n_events_&lt;final&gt;_&lt;patient_id&gt;
</th>
<th style="text-align:right;">
n_events_&lt;final&gt;_&lt;pfs&gt;
</th>
<th style="text-align:right;">
n_events_&lt;final&gt;_&lt;os&gt;
</th>
<th style="text-align:right;">
n_events_&lt;final&gt;_&lt;surrogate&gt;
</th>
<th style="text-align:left;">
n_events_&lt;final&gt;_&lt;arms&gt;
</th>
<th style="text-align:left;">
pfs_high_dose_decision
</th>
<th style="text-align:left;">
pfs_low_dose_decision
</th>
<th style="text-align:left;">
os_high_dose_decision
</th>
<th style="text-align:left;">
os_low_dose_decision
</th>
<th style="text-align:left;">
error_message
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
Trial-3415
</td>
<td style="text-align:right;">
1727811904
</td>
<td style="text-align:right;">
11.12051
</td>
<td style="text-align:right;">
357
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:left;">
c(119, 4….
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
17.99494
</td>
<td style="text-align:right;">
581
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
524
</td>
<td style="text-align:left;">
c(290, 1….
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
25.74756
</td>
<td style="text-align:right;">
881
</td>
<td style="text-align:right;">
596
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
880
</td>
<td style="text-align:left;">
c(441, 2….
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
</td>
</tr></tbody>
</table>
</div>
<p>Here we dive into the action function (<code>action3</code>) for the
final analysis. We can literally execute the function line by line with
locked data loaded. Note that the member functions
<code>Trial$dunnettTest</code> and <code>Trial$closedTest</code> can
make use of locked data at multiple stages (through the
<code>milestones</code> argument) automatically, thus, unlike in
<code>action3</code>, an explicit call of
<code>Trial$get_locked_data(milestone_name)</code> is unnecessary.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## test PFS</span></span>
<span><span class="va">dt_pfs</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">dunnettTest</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">pfs</span>, <span class="va">pfs_event</span><span class="op">)</span> <span class="op">~</span> <span class="va">arm</span>, placebo <span class="op">=</span> <span class="st">'placebo'</span>,</span>
<span>                            treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span>
<span>                            milestones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dose selection'</span>, <span class="st">'interim'</span>, <span class="st">'final'</span><span class="op">)</span>,</span>
<span>                            alternative <span class="op">=</span> <span class="st">'less'</span>, </span>
<span>                            planned_info <span class="op">=</span> <span class="st">'default'</span><span class="op">)</span></span>
<span><span class="va">ct_pfs</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">closedTest</span><span class="op">(</span><span class="va">dt_pfs</span>, treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span>
<span>                           milestones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'interim'</span>, <span class="st">'final'</span><span class="op">)</span>,</span>
<span>                           alpha <span class="op">=</span> <span class="fl">.005</span>, alpha_spending <span class="op">=</span> <span class="st">'asOF'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## test OS</span></span>
<span><span class="va">dt_os</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">dunnettTest</span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">os</span>, <span class="va">os_event</span><span class="op">)</span> <span class="op">~</span> <span class="va">arm</span>, placebo <span class="op">=</span> <span class="st">'placebo'</span>,</span>
<span>                           treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span>
<span>                           milestones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'dose selection'</span>, <span class="st">'final'</span><span class="op">)</span>,</span>
<span>                           alternative <span class="op">=</span> <span class="st">'less'</span>, </span>
<span>                           planned_info <span class="op">=</span> <span class="st">'default'</span><span class="op">)</span></span>
<span><span class="va">ct_os</span> <span class="op">&lt;-</span> <span class="va">trial</span><span class="op">$</span><span class="fu">closedTest</span><span class="op">(</span><span class="va">dt_pfs</span>, treatments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'high dose'</span>, <span class="st">'low dose'</span><span class="op">)</span>,</span>
<span>                          milestones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'final'</span><span class="op">)</span>,</span>
<span>                          alpha <span class="op">=</span> <span class="fl">.02</span>, alpha_spending <span class="op">=</span> <span class="st">'asOF'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ct_pfs</span><span class="op">)</span></span>
<span><span class="co">#&gt;         arm decision milestone_at_reject reject_time</span></span>
<span><span class="co">#&gt; 1 high dose   accept                &lt;NA&gt;         Inf</span></span>
<span><span class="co">#&gt; 2  low dose   reject               final    25.74756</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ct_os</span><span class="op">)</span></span>
<span><span class="co">#&gt;         arm decision milestone_at_reject reject_time</span></span>
<span><span class="co">#&gt; 1 high dose   accept                &lt;NA&gt;         Inf</span></span>
<span><span class="co">#&gt; 2  low dose   reject               final    25.74756</span></span></code></pre></div>
<p>The two null hypotheses of <code>PFS</code> and <code>OS</code> are
both accepted for the high dose because it is dropped at dose selection.
Thus, <code>milestone_at_reject</code> is <code>NA</code>, and the
<code>reject_time</code> is infinite. In contrast, <code>PFS</code> and
<code>OS</code> are significant in low does. Note that even if
<code>PFS</code> are tested at interim and final, one cannot claim its
significance until the final analysis
(<code>milestone_at_reject</code>). The <code>reject_time</code>
(25.7475563) can be saved to the output using the member function
<code>Trial$save</code>.</p>
<p><code>TrialSimulator</code> abstracts the data generation and
management to allow user focus on implementing the statistical analysis.
It simulates a trial on patient level, and provide flexibility in
adaptive design.</p>
</div>
<div class="section level2">
<h2 id="execute-trial-simulation">Execute Trial Simulation<a class="anchor" aria-label="anchor" href="#execute-trial-simulation"></a>
</h2>
<p>We can run a massive number of replicates in simulation to study
operating characteristics of a trial design by specifying <code>n</code>
in <code>Controller$run()</code>. We can set
<code>plot_event = FALSE</code> to turn off plotting to save running
time.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## reset a controller if $run has been executed before</span></span>
<span><span class="va">controller</span><span class="op">$</span><span class="fu">reset</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">controller</span><span class="op">$</span><span class="fu">run</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1000</span>, plot_event <span class="op">=</span> <span class="cn">FALSE</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">output</span> <span class="op">&lt;-</span> <span class="va">controller</span><span class="op">$</span><span class="fu">get_output</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>escape <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>bootstrap_options <span class="op">=</span> <span class="st">"striped"</span>, </span>
<span>                full_width <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                position <span class="op">=</span> <span class="st">"left"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">scroll_box</span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span></span></code></pre></div>
<div style="border: 1px solid #ddd; padding: 5px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped" style="width: auto !important; ">
<thead><tr>
<th style="text-align:left;">
trial
</th>
<th style="text-align:right;">
seed
</th>
<th style="text-align:right;">
milestone_time_&lt;dose selection&gt;
</th>
<th style="text-align:right;">
n_events_&lt;dose selection&gt;_&lt;patient_id&gt;
</th>
<th style="text-align:right;">
n_events_&lt;dose selection&gt;_&lt;pfs&gt;
</th>
<th style="text-align:right;">
n_events_&lt;dose selection&gt;_&lt;os&gt;
</th>
<th style="text-align:right;">
n_events_&lt;dose selection&gt;_&lt;surrogate&gt;
</th>
<th style="text-align:left;">
n_events_&lt;dose selection&gt;_&lt;arms&gt;
</th>
<th style="text-align:left;">
kept_arm
</th>
<th style="text-align:right;">
milestone_time_&lt;interim&gt;
</th>
<th style="text-align:right;">
n_events_&lt;interim&gt;_&lt;patient_id&gt;
</th>
<th style="text-align:right;">
n_events_&lt;interim&gt;_&lt;pfs&gt;
</th>
<th style="text-align:right;">
n_events_&lt;interim&gt;_&lt;os&gt;
</th>
<th style="text-align:right;">
n_events_&lt;interim&gt;_&lt;surrogate&gt;
</th>
<th style="text-align:left;">
n_events_&lt;interim&gt;_&lt;arms&gt;
</th>
<th style="text-align:left;">
futility
</th>
<th style="text-align:right;">
milestone_time_&lt;final&gt;
</th>
<th style="text-align:right;">
n_events_&lt;final&gt;_&lt;patient_id&gt;
</th>
<th style="text-align:right;">
n_events_&lt;final&gt;_&lt;pfs&gt;
</th>
<th style="text-align:right;">
n_events_&lt;final&gt;_&lt;os&gt;
</th>
<th style="text-align:right;">
n_events_&lt;final&gt;_&lt;surrogate&gt;
</th>
<th style="text-align:left;">
n_events_&lt;final&gt;_&lt;arms&gt;
</th>
<th style="text-align:left;">
pfs_high_dose_decision
</th>
<th style="text-align:left;">
pfs_low_dose_decision
</th>
<th style="text-align:left;">
os_high_dose_decision
</th>
<th style="text-align:left;">
os_low_dose_decision
</th>
<th style="text-align:left;">
error_message
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Trial-3415
</td>
<td style="text-align:right;">
1727811904
</td>
<td style="text-align:right;">
11.31385
</td>
<td style="text-align:right;">
366
</td>
<td style="text-align:right;">
142
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:left;">
c(122, 4….
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
19.16584
</td>
<td style="text-align:right;">
637
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
534
</td>
<td style="text-align:left;">
c(319, 1….
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
29.44763
</td>
<td style="text-align:right;">
878
</td>
<td style="text-align:right;">
542
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
744
</td>
<td style="text-align:left;">
c(439, 2….
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Trial-3415
</td>
<td style="text-align:right;">
776792356
</td>
<td style="text-align:right;">
11.33385
</td>
<td style="text-align:right;">
367
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
68
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:left;">
c(123, 4….
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
19.52434
</td>
<td style="text-align:right;">
654
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
544
</td>
<td style="text-align:left;">
c(327, 1….
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
29.56296
</td>
<td style="text-align:right;">
877
</td>
<td style="text-align:right;">
520
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
748
</td>
<td style="text-align:left;">
c(439, 2….
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Trial-3415
</td>
<td style="text-align:right;">
1430198130
</td>
<td style="text-align:right;">
11.41385
</td>
<td style="text-align:right;">
371
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:left;">
c(124, 4….
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
19.99458
</td>
<td style="text-align:right;">
677
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
158
</td>
<td style="text-align:right;">
554
</td>
<td style="text-align:left;">
c(339, 1….
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
30.26166
</td>
<td style="text-align:right;">
877
</td>
<td style="text-align:right;">
546
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
740
</td>
<td style="text-align:left;">
c(439, 2….
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Trial-3415
</td>
<td style="text-align:right;">
1400866922
</td>
<td style="text-align:right;">
11.29385
</td>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
65
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:left;">
c(122, 4….
</td>
<td style="text-align:left;">
high
</td>
<td style="text-align:right;">
19.48899
</td>
<td style="text-align:right;">
653
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
140
</td>
<td style="text-align:right;">
547
</td>
<td style="text-align:left;">
c(326, 1….
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
28.74682
</td>
<td style="text-align:right;">
878
</td>
<td style="text-align:right;">
541
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
755
</td>
<td style="text-align:left;">
c(439, 2….
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Trial-3415
</td>
<td style="text-align:right;">
1898009641
</td>
<td style="text-align:right;">
11.19385
</td>
<td style="text-align:right;">
360
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
60
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:left;">
c(120, 4….
</td>
<td style="text-align:left;">
low
</td>
<td style="text-align:right;">
19.73958
</td>
<td style="text-align:right;">
667
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
151
</td>
<td style="text-align:right;">
550
</td>
<td style="text-align:left;">
c(334, 1….
</td>
<td style="text-align:left;">
negative
</td>
<td style="text-align:right;">
28.64718
</td>
<td style="text-align:right;">
880
</td>
<td style="text-align:right;">
534
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
743
</td>
<td style="text-align:left;">
c(440, 2….
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
accept
</td>
<td style="text-align:left;">
reject
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    time_dose_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`milestone_time_&lt;dose selection&gt;`</span><span class="op">)</span>, </span>
<span>    time_interim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`milestone_time_&lt;interim&gt;`</span><span class="op">)</span>, </span>
<span>    time_final <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`milestone_time_&lt;final&gt;`</span><span class="op">)</span>, </span>
<span>    n_dose_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;dose selection&gt;_&lt;patient_id&gt;`</span><span class="op">)</span>, </span>
<span>    n_interim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;interim&gt;_&lt;patient_id&gt;`</span><span class="op">)</span>, </span>
<span>    n_final <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;final&gt;_&lt;patient_id&gt;`</span><span class="op">)</span>, </span>
<span>    low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">kept_arm</span> <span class="op">==</span> <span class="st">'low'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">kept_arm</span> <span class="op">==</span> <span class="st">'high'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    both <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">kept_arm</span> <span class="op">==</span> <span class="st">'both'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>col.names <span class="op">=</span> <span class="cn">NULL</span>, digits <span class="op">=</span> <span class="fl">1</span>, align <span class="op">=</span> <span class="st">'r'</span>, </span>
<span>        caption <span class="op">=</span> <span class="st">'Number of Randomized Patients at Stages'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Dose Selection'</span>, <span class="st">'Interim'</span>, <span class="st">'Final'</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>                     <span class="st">'Low Dose'</span>, <span class="st">'High Dose'</span>, <span class="st">'Both'</span><span class="op">)</span>, align <span class="op">=</span> <span class="st">'r'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Time'</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">'Number of Patients'</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">'Selected Dose (%)'</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Number of Randomized Patients at Stages
</caption>
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Time
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Number of Patients
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Selected Dose (%)
</div>
</th>
</tr>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Dose Selection
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Interim
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Final
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Dose Selection
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Interim
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Final
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Low Dose
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
High Dose
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Both
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
</tr>
</thead>
<tbody><tr>
<td style="text-align:right;">
11.3
</td>
<td style="text-align:right;">
19.1
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
365
</td>
<td style="text-align:right;">
647.6
</td>
<td style="text-align:right;">
893.2
</td>
<td style="text-align:right;">
70.5
</td>
<td style="text-align:right;">
17.3
</td>
<td style="text-align:right;">
12.2
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n_pfs_dose_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;dose selection&gt;_&lt;pfs&gt;`</span><span class="op">)</span>, </span>
<span>    n_pfs_interim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;interim&gt;_&lt;pfs&gt;`</span><span class="op">)</span>,</span>
<span>    n_pfs_final <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;final&gt;_&lt;pfs&gt;`</span><span class="op">)</span>,</span>
<span>    n_os_dose_selection <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;dose selection&gt;_&lt;os&gt;`</span><span class="op">)</span>, </span>
<span>    n_os_interim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;interim&gt;_&lt;os&gt;`</span><span class="op">)</span>,</span>
<span>    n_os_final <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">`n_events_&lt;final&gt;_&lt;os&gt;`</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>col.names <span class="op">=</span> <span class="cn">NULL</span>, digits <span class="op">=</span> <span class="fl">1</span>, align <span class="op">=</span> <span class="st">'r'</span>, </span>
<span>        caption <span class="op">=</span> <span class="st">'Number of Events of PFS and OS at Stages'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Dose Selection'</span>, <span class="st">'Interim'</span>, <span class="st">'Final'</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, align <span class="op">=</span> <span class="st">'r'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PFS'</span> <span class="op">=</span> <span class="fl">3</span>, <span class="st">'OS'</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Number of Events of PFS and OS at Stages
</caption>
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
PFS
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
OS
</div>
</th>
</tr>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Dose Selection
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Interim
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Final
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Dose Selection
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Interim
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Final
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
</tr>
</thead>
<tbody><tr>
<td style="text-align:right;">
144.4
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
532.8
</td>
<td style="text-align:right;">
67.9
</td>
<td style="text-align:right;">
152.2
</td>
<td style="text-align:right;">
301.9
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    power_pfs_low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pfs_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    power_pfs_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pfs_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    power_pfs_or <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pfs_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">|</span> <span class="va">pfs_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    power_pfs_and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">pfs_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">&amp;</span> <span class="va">pfs_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    power_os_low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">os_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    power_os_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">os_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    power_os_or <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">os_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">|</span> <span class="va">os_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    power_os_and <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">os_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">&amp;</span> <span class="va">os_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>col.names <span class="op">=</span> <span class="cn">NULL</span>, digits <span class="op">=</span> <span class="fl">1</span>, align <span class="op">=</span> <span class="st">'r'</span>, </span>
<span>        caption <span class="op">=</span> <span class="st">'Power of Testing PFS and OS'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Low Dose'</span>, <span class="st">'High Dose'</span>, <span class="st">'Low or High'</span>, <span class="st">'Low and High'</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span>, align <span class="op">=</span> <span class="st">'r'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'PFS (%)'</span> <span class="op">=</span> <span class="fl">4</span>, <span class="st">'OS (%)'</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Power of Testing PFS and OS
</caption>
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
PFS (%)
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
OS (%)
</div>
</th>
</tr>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Low Dose
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
High Dose
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Low or High
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Low and High
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Low Dose
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
High Dose
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Low or High
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Low and High
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
</tr>
</thead>
<tbody><tr>
<td style="text-align:right;">
57.6
</td>
<td style="text-align:right;">
24.6
</td>
<td style="text-align:right;">
75.4
</td>
<td style="text-align:right;">
6.8
</td>
<td style="text-align:right;">
72.1
</td>
<td style="text-align:right;">
27.4
</td>
<td style="text-align:right;">
90.6
</td>
<td style="text-align:right;">
8.9
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    power_pfs_not_os <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pfs_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">|</span> <span class="va">pfs_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                              <span class="va">os_low_dose_decision</span> <span class="op">==</span> <span class="st">'accept'</span> <span class="op">&amp;</span> <span class="va">os_high_dose_decision</span> <span class="op">==</span> <span class="st">'accept'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    power_os_not_pfs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">os_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">|</span> <span class="va">os_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                              <span class="va">pfs_low_dose_decision</span> <span class="op">==</span> <span class="st">'accept'</span> <span class="op">&amp;</span> <span class="va">pfs_high_dose_decision</span> <span class="op">==</span> <span class="st">'accept'</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, </span>
<span>    power_pfs_and_os <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pfs_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">|</span> <span class="va">pfs_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">&amp;</span> </span>
<span>                              <span class="op">(</span><span class="va">os_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">|</span> <span class="va">os_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    power_pfs_or_os <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">pfs_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">|</span> <span class="va">pfs_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span> <span class="op">|</span> </span>
<span>                              <span class="op">(</span><span class="va">os_low_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span> <span class="op">|</span> <span class="va">os_high_dose_decision</span> <span class="op">==</span> <span class="st">'reject'</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable</span><span class="op">(</span>col.names <span class="op">=</span> <span class="cn">NULL</span>, digits <span class="op">=</span> <span class="fl">1</span>, align <span class="op">=</span> <span class="st">'r'</span>, </span>
<span>        caption <span class="op">=</span> <span class="st">'Power of Testing PFS and OS (Cont.)'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">add_header_above</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Reject PFS and Accept OS'</span>, <span class="st">'Accept PFS and Reject OS'</span>, </span>
<span>                     <span class="st">'Reject PFS and OS'</span>, <span class="st">'Reject PFS or OS'</span><span class="op">)</span>, align <span class="op">=</span> <span class="st">'r'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">kable_styling</span><span class="op">(</span>full_width <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Power of Testing PFS and OS (Cont.)
</caption>
<thead>
<tr>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Reject PFS and Accept OS
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Accept PFS and Reject OS
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Reject PFS and OS
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: right; " colspan="1">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Reject PFS or OS
</div>
</th>
</tr>
<tr>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
<th style="text-align:right;">
</th>
</tr>
</thead>
<tbody><tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
15.2
</td>
<td style="text-align:right;">
75.4
</td>
<td style="text-align:right;">
90.6
</td>
</tr></tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Han Zhang.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
